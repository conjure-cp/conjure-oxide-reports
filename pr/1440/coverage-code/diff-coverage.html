<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
    <head>
        <meta http-equiv='Content-Type' content='text/html; charset=utf-8'>
        <title>Diff Coverage</title>
        <style>
            .src-snippet { margin-top: 2em; }
            .src-name { font-weight: bold; }
            .snippets {
                border-top: 1px solid #bdbdbd;
                border-bottom: 1px solid #bdbdbd;
            }
            pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.hll { background-color: #ffcccc }
.c { color: #3D7B7B; font-style: italic } /* Comment */
.err { border: 1px solid #F00 } /* Error */
.k { color: #008000; font-weight: bold } /* Keyword */
.o { color: #666 } /* Operator */
.ch { color: #3D7B7B; font-style: italic } /* Comment.Hashbang */
.cm { color: #3D7B7B; font-style: italic } /* Comment.Multiline */
.cp { color: #9C6500 } /* Comment.Preproc */
.cpf { color: #3D7B7B; font-style: italic } /* Comment.PreprocFile */
.c1 { color: #3D7B7B; font-style: italic } /* Comment.Single */
.cs { color: #3D7B7B; font-style: italic } /* Comment.Special */
.gd { color: #A00000 } /* Generic.Deleted */
.ge { font-style: italic } /* Generic.Emph */
.ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.gr { color: #E40000 } /* Generic.Error */
.gh { color: #000080; font-weight: bold } /* Generic.Heading */
.gi { color: #008400 } /* Generic.Inserted */
.go { color: #717171 } /* Generic.Output */
.gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.gs { font-weight: bold } /* Generic.Strong */
.gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.gt { color: #04D } /* Generic.Traceback */
.kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.kp { color: #008000 } /* Keyword.Pseudo */
.kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.kt { color: #B00040 } /* Keyword.Type */
.m { color: #666 } /* Literal.Number */
.s { color: #BA2121 } /* Literal.String */
.na { color: #687822 } /* Name.Attribute */
.nb { color: #008000 } /* Name.Builtin */
.nc { color: #00F; font-weight: bold } /* Name.Class */
.no { color: #800 } /* Name.Constant */
.nd { color: #A2F } /* Name.Decorator */
.ni { color: #717171; font-weight: bold } /* Name.Entity */
.ne { color: #CB3F38; font-weight: bold } /* Name.Exception */
.nf { color: #00F } /* Name.Function */
.nl { color: #767600 } /* Name.Label */
.nn { color: #00F; font-weight: bold } /* Name.Namespace */
.nt { color: #008000; font-weight: bold } /* Name.Tag */
.nv { color: #19177C } /* Name.Variable */
.ow { color: #A2F; font-weight: bold } /* Operator.Word */
.w { color: #BBB } /* Text.Whitespace */
.mb { color: #666 } /* Literal.Number.Bin */
.mf { color: #666 } /* Literal.Number.Float */
.mh { color: #666 } /* Literal.Number.Hex */
.mi { color: #666 } /* Literal.Number.Integer */
.mo { color: #666 } /* Literal.Number.Oct */
.sa { color: #BA2121 } /* Literal.String.Affix */
.sb { color: #BA2121 } /* Literal.String.Backtick */
.sc { color: #BA2121 } /* Literal.String.Char */
.dl { color: #BA2121 } /* Literal.String.Delimiter */
.sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.s2 { color: #BA2121 } /* Literal.String.Double */
.se { color: #AA5D1F; font-weight: bold } /* Literal.String.Escape */
.sh { color: #BA2121 } /* Literal.String.Heredoc */
.si { color: #A45A77; font-weight: bold } /* Literal.String.Interpol */
.sx { color: #008000 } /* Literal.String.Other */
.sr { color: #A45A77 } /* Literal.String.Regex */
.s1 { color: #BA2121 } /* Literal.String.Single */
.ss { color: #19177C } /* Literal.String.Symbol */
.bp { color: #008000 } /* Name.Builtin.Pseudo */
.fm { color: #00F } /* Name.Function.Magic */
.vc { color: #19177C } /* Name.Variable.Class */
.vg { color: #19177C } /* Name.Variable.Global */
.vi { color: #19177C } /* Name.Variable.Instance */
.vm { color: #19177C } /* Name.Variable.Magic */
.il { color: #666 } /* Literal.Number.Integer.Long */
        </style>
    </head>
    <body>
        <h1>Diff Coverage</h1>
        <p>Diff: upstream/main...HEAD, staged and unstaged changes</p>
        <ul>
            <li><b>Total</b>: 399 lines</li>
            <li><b>Missing</b>: 124 lines</li>
            <li><b>Coverage</b>: 68%</li>
        </ul>
        <table border="1">
            <tr>
                <th>Source File</th>
                <th>Diff Coverage (%)</th>
                <th>Missing Lines</th>
            </tr>
            <tr>
                <td>crates/conjure-cp-cli/src/utils/conjure.rs</td>
                <td>100%</td>
                <td>&nbsp;</td>
            </tr>
            <tr>
                <td>crates/conjure-cp-core/src/ast/abstract_comprehension.rs</td>
                <td>60.0%</td>
                <td>46,126,131,185</td>
            </tr>
            <tr>
                <td>crates/conjure-cp-core/src/ast/comprehension.rs</td>
                <td>93.8%</td>
                <td>196</td>
            </tr>
            <tr>
                <td>crates/conjure-cp-core/src/ast/declaration.rs</td>
                <td>64.5%</td>
                <td>31,350-351,374-377,415,421,423-424,473-477,483-486,605,635</td>
            </tr>
            <tr>
                <td>crates/conjure-cp-core/src/ast/domains/domain.rs</td>
                <td>100%</td>
                <td>&nbsp;</td>
            </tr>
            <tr>
                <td>crates/conjure-cp-core/src/ast/model.rs</td>
                <td>78.8%</td>
                <td>276,281-283,290-292</td>
            </tr>
            <tr>
                <td>crates/conjure-cp-core/src/ast/reference.rs</td>
                <td>100%</td>
                <td>&nbsp;</td>
            </tr>
            <tr>
                <td>crates/conjure-cp-core/src/ast/serde.rs</td>
                <td>50.0%</td>
                <td>67-69,71-73,104-106,109,116-118,120-121,129,145,147</td>
            </tr>
            <tr>
                <td>crates/conjure-cp-core/src/ast/submodel.rs</td>
                <td>100%</td>
                <td>&nbsp;</td>
            </tr>
            <tr>
                <td>crates/conjure-cp-core/src/ast/symbol_table.rs</td>
                <td>56.1%</td>
                <td>97-101,104-107,109-111,117-118,124-126,130,136-138,145,147,150-154,156-158,160,162,165,167,170-174,176-178,186-190,196-197,200-204,211,213-214,252,354,405,510,530,542-544,564-566</td>
            </tr>
            <tr>
                <td>crates/conjure-cp-core/src/parse/parse_model.rs</td>
                <td>90.9%</td>
                <td>771,1092</td>
            </tr>
            <tr>
                <td>crates/conjure-cp-essence-parser/src/parser/abstract_literal.rs</td>
                <td>100%</td>
                <td>&nbsp;</td>
            </tr>
            <tr>
                <td>crates/conjure-cp-essence-parser/src/parser/atom.rs</td>
                <td>100%</td>
                <td>&nbsp;</td>
            </tr>
            <tr>
                <td>crates/conjure-cp-essence-parser/src/parser/comprehension.rs</td>
                <td>100%</td>
                <td>&nbsp;</td>
            </tr>
            <tr>
                <td>crates/conjure-cp-essence-parser/src/parser/domain.rs</td>
                <td>100%</td>
                <td>&nbsp;</td>
            </tr>
            <tr>
                <td>crates/conjure-cp-essence-parser/src/parser/expression.rs</td>
                <td>85.7%</td>
                <td>40</td>
            </tr>
            <tr>
                <td>crates/conjure-cp-essence-parser/src/parser/find.rs</td>
                <td>100%</td>
                <td>&nbsp;</td>
            </tr>
            <tr>
                <td>crates/conjure-cp-essence-parser/src/parser/letting.rs</td>
                <td>100%</td>
                <td>&nbsp;</td>
            </tr>
            <tr>
                <td>crates/conjure-cp-essence-parser/src/parser/parse_exprs.rs</td>
                <td>100%</td>
                <td>&nbsp;</td>
            </tr>
            <tr>
                <td>crates/conjure-cp-essence-parser/src/parser/parse_literal.rs</td>
                <td>100%</td>
                <td>&nbsp;</td>
            </tr>
            <tr>
                <td>crates/conjure-cp-rules/src/comprehensions/expansion/expand_ac.rs</td>
                <td>100%</td>
                <td>&nbsp;</td>
            </tr>
            <tr>
                <td>crates/conjure-cp-rules/src/select_representation.rs</td>
                <td>100%</td>
                <td>&nbsp;</td>
            </tr>
        </table>
        <div class="src-snippet">
            <div class="src-name">crates/conjure-cp-core/src/ast/abstract_comprehension.rs</div>
            <div class="snippets">
            <div class="snippet"><table class="snippettable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span></pre></div></td><td class="code"><div><pre><span></span><a id="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-42" name="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-42"></a><span class="cp">#[derive(Clone, PartialEq, Eq, Serialize, Deserialize, Debug, Hash, Uniplate)]</span>
<a id="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-43" name="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-43"></a><span class="cp">#[biplate(to=Expression)]</span>
<a id="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-44" name="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-44"></a><span class="cp">#[biplate(to=SubModel)]</span>
<a id="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-45" name="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-45"></a><span class="k">pub</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">ComprehensionLetting</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-46" name="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-46"></a><span class="hll"><span class="w">    </span><span class="cp">#[serde_as(as = </span><span class="s">&quot;PtrAsInner&quot;</span><span class="cp">)]</span>
</span><a id="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-47" name="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-47"></a><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="n">decl</span><span class="p">:</span><span class="w"> </span><span class="nc">DeclarationPtr</span><span class="p">,</span>
<a id="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-48" name="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-48"></a><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="n">expression</span><span class="p">:</span><span class="w"> </span><span class="nc">Expression</span><span class="p">,</span>
<a id="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-49" name="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-49"></a><span class="p">}</span>
</pre></div></td></tr></table></div>

            <div class="snippet"><table class="snippettable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span></pre></div></td><td class="code"><div><pre><span></span><a id="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-122" name="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-122"></a><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span><span class="w"> </span><span class="nf">return_expr_symbols</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">SymbolTablePtr</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-123" name="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-123"></a><span class="w">        </span><span class="bp">self</span><span class="p">.</span><span class="n">return_expr_symbols</span><span class="p">.</span><span class="n">clone</span><span class="p">()</span>
<a id="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-124" name="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-124"></a><span class="w">    </span><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-125" name="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-125"></a>
<a id="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-126" name="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-126"></a><span class="hll"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span><span class="w"> </span><span class="nf">generator_symbols</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">SymbolTablePtr</span><span class="w"> </span><span class="p">{</span>
</span><a id="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-127" name="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-127"></a><span class="w">        </span><span class="bp">self</span><span class="p">.</span><span class="n">generator_symbols</span><span class="p">.</span><span class="n">clone</span><span class="p">()</span>
<a id="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-128" name="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-128"></a><span class="w">    </span><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-129" name="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-129"></a>
<a id="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-130" name="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-130"></a><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span><span class="w"> </span><span class="nf">new_domain_generator</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">domain</span><span class="p">:</span><span class="w"> </span><span class="nc">DomainPtr</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">DeclarationPtr</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-131" name="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-131"></a><span class="hll"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">generator_decl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">return_expr_symbols</span><span class="p">.</span><span class="n">write</span><span class="p">().</span><span class="n">gensym</span><span class="p">(</span><span class="o">&amp;</span><span class="n">domain</span><span class="p">);</span>
</span><a id="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-132" name="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-132"></a>
<a id="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-133" name="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-133"></a><span class="w">        </span><span class="bp">self</span><span class="p">.</span><span class="n">qualifiers</span>
<a id="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-134" name="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-134"></a><span class="w">            </span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">Qualifier</span><span class="p">::</span><span class="n">Generator</span><span class="p">(</span><span class="n">Generator</span><span class="p">::</span><span class="n">DomainGenerator</span><span class="p">(</span>
<a id="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-135" name="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-135"></a><span class="w">                </span><span class="n">DomainGenerator</span><span class="w"> </span><span class="p">{</span>
</pre></div></td></tr></table></div>

            <div class="snippet"><table class="snippettable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span></pre></div></td><td class="code"><div><pre><span></span><a id="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-181" name="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-181"></a><span class="w">        </span><span class="bp">self</span><span class="p">.</span><span class="n">qualifiers</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">Qualifier</span><span class="p">::</span><span class="n">Condition</span><span class="p">(</span><span class="n">condition</span><span class="p">));</span>
<a id="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-182" name="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-182"></a><span class="w">    </span><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-183" name="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-183"></a>
<a id="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-184" name="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-184"></a><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span><span class="w"> </span><span class="nf">new_letting</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">expression</span><span class="p">:</span><span class="w"> </span><span class="nc">Expression</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">DeclarationPtr</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-185" name="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-185"></a><span class="hll"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">letting_decl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">return_expr_symbols</span><span class="p">.</span><span class="n">write</span><span class="p">().</span><span class="n">gensym</span><span class="p">(</span>
</span><a id="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-186" name="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-186"></a><span class="w">            </span><span class="o">&amp;</span><span class="n">expression</span>
<a id="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-187" name="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-187"></a><span class="w">                </span><span class="p">.</span><span class="n">domain_of</span><span class="p">()</span>
<a id="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-188" name="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-188"></a><span class="w">                </span><span class="p">.</span><span class="n">expect</span><span class="p">(</span><span class="s">&quot;Expression must have a domain&quot;</span><span class="p">),</span>
<a id="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-189" name="crates/conjure-cp-core/src/ast/abstract_comprehension.rs-189"></a><span class="w">        </span><span class="p">);</span>
</pre></div></td></tr></table></div>

            </div>
        </div>
        <div class="src-snippet">
            <div class="src-name">crates/conjure-cp-core/src/ast/comprehension.rs</div>
            <div class="snippets">
            <div class="snippet"><table class="snippettable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span></pre></div></td><td class="code"><div><pre><span></span><a id="crates/conjure-cp-core/src/ast/comprehension.rs-192" name="crates/conjure-cp-core/src/ast/comprehension.rs-192"></a><span class="w">        </span><span class="k">mut</span><span class="w"> </span><span class="n">expression</span><span class="p">:</span><span class="w"> </span><span class="nc">Expression</span><span class="p">,</span>
<a id="crates/conjure-cp-core/src/ast/comprehension.rs-193" name="crates/conjure-cp-core/src/ast/comprehension.rs-193"></a><span class="w">        </span><span class="n">comprehension_kind</span><span class="p">:</span><span class="w"> </span><span class="nb">Option</span><span class="o">&lt;</span><span class="n">ACOperatorKind</span><span class="o">&gt;</span><span class="p">,</span>
<a id="crates/conjure-cp-core/src/ast/comprehension.rs-194" name="crates/conjure-cp-core/src/ast/comprehension.rs-194"></a><span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">Comprehension</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/comprehension.rs-195" name="crates/conjure-cp-core/src/ast/comprehension.rs-195"></a><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">parent_symboltable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">generator_symboltable</span><span class="p">.</span><span class="n">read</span><span class="p">().</span><span class="n">parent</span><span class="p">().</span><span class="n">clone</span><span class="p">().</span><span class="n">unwrap</span><span class="p">();</span>
<a id="crates/conjure-cp-core/src/ast/comprehension.rs-196" name="crates/conjure-cp-core/src/ast/comprehension.rs-196"></a><span class="hll">
</span><a id="crates/conjure-cp-core/src/ast/comprehension.rs-197" name="crates/conjure-cp-core/src/ast/comprehension.rs-197"></a><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">generator_submodel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SubModel</span><span class="p">::</span><span class="n">new</span><span class="p">(</span><span class="n">parent_symboltable</span><span class="p">.</span><span class="n">clone</span><span class="p">());</span>
<a id="crates/conjure-cp-core/src/ast/comprehension.rs-198" name="crates/conjure-cp-core/src/ast/comprehension.rs-198"></a><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">return_expression_submodel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SubModel</span><span class="p">::</span><span class="n">new</span><span class="p">(</span><span class="n">parent_symboltable</span><span class="p">);</span>
<a id="crates/conjure-cp-core/src/ast/comprehension.rs-199" name="crates/conjure-cp-core/src/ast/comprehension.rs-199"></a>
<a id="crates/conjure-cp-core/src/ast/comprehension.rs-200" name="crates/conjure-cp-core/src/ast/comprehension.rs-200"></a><span class="w">        </span><span class="o">*</span><span class="n">generator_submodel</span><span class="p">.</span><span class="n">symbols_ptr_unchecked_mut</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">generator_symboltable</span><span class="p">;</span>
</pre></div></td></tr></table></div>

            </div>
        </div>
        <div class="src-snippet">
            <div class="src-name">crates/conjure-cp-core/src/ast/declaration.rs</div>
            <div class="snippets">
            <div class="snippet"><table class="snippettable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span></pre></div></td><td class="code"><div><pre><span></span><a id="crates/conjure-cp-core/src/ast/declaration.rs-27" name="crates/conjure-cp-core/src/ast/declaration.rs-27"></a><span class="sd">/// Resets the id counter of `DeclarationPtr` to 0.</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-28" name="crates/conjure-cp-core/src/ast/declaration.rs-28"></a><span class="sd">///</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-29" name="crates/conjure-cp-core/src/ast/declaration.rs-29"></a><span class="sd">/// This is probably always a bad idea.</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-30" name="crates/conjure-cp-core/src/ast/declaration.rs-30"></a><span class="k">pub</span><span class="w"> </span><span class="k">fn</span><span class="w"> </span><span class="nf">reset_declaration_id_unchecked</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-31" name="crates/conjure-cp-core/src/ast/declaration.rs-31"></a><span class="hll"><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DECLARATION_PTR_ID_COUNTER</span><span class="p">.</span><span class="n">swap</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">Ordering</span><span class="p">::</span><span class="n">Relaxed</span><span class="p">);</span>
</span><a id="crates/conjure-cp-core/src/ast/declaration.rs-32" name="crates/conjure-cp-core/src/ast/declaration.rs-32"></a><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-33" name="crates/conjure-cp-core/src/ast/declaration.rs-33"></a>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-34" name="crates/conjure-cp-core/src/ast/declaration.rs-34"></a><span class="sd">/// A shared pointer to a [`Declaration`].</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-35" name="crates/conjure-cp-core/src/ast/declaration.rs-35"></a><span class="sd">///</span>
</pre></div></td></tr></table></div>

            <div class="snippet"><table class="snippettable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span></pre></div></td><td class="code"><div><pre><span></span><a id="crates/conjure-cp-core/src/ast/declaration.rs-346" name="crates/conjure-cp-core/src/ast/declaration.rs-346"></a><span class="w">        </span><span class="p">.</span><span class="n">ok</span><span class="p">()</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-347" name="crates/conjure-cp-core/src/ast/declaration.rs-347"></a><span class="w">    </span><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-348" name="crates/conjure-cp-core/src/ast/declaration.rs-348"></a>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-349" name="crates/conjure-cp-core/src/ast/declaration.rs-349"></a><span class="w">    </span><span class="sd">/// This declaration as a mutable domain letting, if it is one.</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-350" name="crates/conjure-cp-core/src/ast/declaration.rs-350"></a><span class="hll"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span><span class="w"> </span><span class="nf">as_domain_letting_mut</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nb">Option</span><span class="o">&lt;</span><span class="n">MappedRwLockWriteGuard</span><span class="o">&lt;&#39;</span><span class="nb">_</span><span class="p">,</span><span class="w"> </span><span class="n">DomainPtr</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">{</span>
</span><a id="crates/conjure-cp-core/src/ast/declaration.rs-351" name="crates/conjure-cp-core/src/ast/declaration.rs-351"></a><span class="hll"><span class="w">        </span><span class="n">RwLockWriteGuard</span><span class="p">::</span><span class="n">try_map</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">write</span><span class="p">(),</span><span class="w"> </span><span class="o">|</span><span class="n">x</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
</span><a id="crates/conjure-cp-core/src/ast/declaration.rs-352" name="crates/conjure-cp-core/src/ast/declaration.rs-352"></a><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="kd">let</span><span class="w"> </span><span class="n">DeclarationKind</span><span class="p">::</span><span class="n">DomainLetting</span><span class="p">(</span><span class="n">domain</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="n">kind</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-353" name="crates/conjure-cp-core/src/ast/declaration.rs-353"></a><span class="w">                </span><span class="nb">Some</span><span class="p">(</span><span class="n">domain</span><span class="p">)</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-354" name="crates/conjure-cp-core/src/ast/declaration.rs-354"></a><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-355" name="crates/conjure-cp-core/src/ast/declaration.rs-355"></a><span class="w">                </span><span class="nb">None</span>
</pre></div></td></tr></table></div>

            <div class="snippet"><table class="snippettable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span></pre></div></td><td class="code"><div><pre><span></span><a id="crates/conjure-cp-core/src/ast/declaration.rs-370" name="crates/conjure-cp-core/src/ast/declaration.rs-370"></a><span class="w">        </span><span class="p">.</span><span class="n">ok</span><span class="p">()</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-371" name="crates/conjure-cp-core/src/ast/declaration.rs-371"></a><span class="w">    </span><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-372" name="crates/conjure-cp-core/src/ast/declaration.rs-372"></a>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-373" name="crates/conjure-cp-core/src/ast/declaration.rs-373"></a><span class="w">    </span><span class="sd">/// This declaration as a mutable value letting, if it is one.</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-374" name="crates/conjure-cp-core/src/ast/declaration.rs-374"></a><span class="hll"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span><span class="w"> </span><span class="nf">as_value_letting_mut</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nb">Option</span><span class="o">&lt;</span><span class="n">MappedRwLockWriteGuard</span><span class="o">&lt;&#39;</span><span class="nb">_</span><span class="p">,</span><span class="w"> </span><span class="n">Expression</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">{</span>
</span><a id="crates/conjure-cp-core/src/ast/declaration.rs-375" name="crates/conjure-cp-core/src/ast/declaration.rs-375"></a><span class="hll"><span class="w">        </span><span class="n">RwLockWriteGuard</span><span class="p">::</span><span class="n">try_map</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">write</span><span class="p">(),</span><span class="w"> </span><span class="o">|</span><span class="n">x</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
</span><a id="crates/conjure-cp-core/src/ast/declaration.rs-376" name="crates/conjure-cp-core/src/ast/declaration.rs-376"></a><span class="hll"><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="kd">let</span><span class="w"> </span><span class="n">DeclarationKind</span><span class="p">::</span><span class="n">ValueLetting</span><span class="p">(</span><span class="n">expression</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="n">kind</span><span class="w"> </span><span class="p">{</span>
</span><a id="crates/conjure-cp-core/src/ast/declaration.rs-377" name="crates/conjure-cp-core/src/ast/declaration.rs-377"></a><span class="hll"><span class="w">                </span><span class="nb">Some</span><span class="p">(</span><span class="n">expression</span><span class="p">)</span>
</span><a id="crates/conjure-cp-core/src/ast/declaration.rs-378" name="crates/conjure-cp-core/src/ast/declaration.rs-378"></a><span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-379" name="crates/conjure-cp-core/src/ast/declaration.rs-379"></a><span class="w">                </span><span class="nb">None</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-380" name="crates/conjure-cp-core/src/ast/declaration.rs-380"></a><span class="w">            </span><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-381" name="crates/conjure-cp-core/src/ast/declaration.rs-381"></a><span class="w">        </span><span class="p">})</span>
</pre></div></td></tr></table></div>

            <div class="snippet"><table class="snippettable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span></pre></div></td><td class="code"><div><pre><span></span><a id="crates/conjure-cp-core/src/ast/declaration.rs-411" name="crates/conjure-cp-core/src/ast/declaration.rs-411"></a><span class="w">    </span><span class="sd">/// Read the underlying [Declaration].</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-412" name="crates/conjure-cp-core/src/ast/declaration.rs-412"></a><span class="w">    </span><span class="sd">///</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-413" name="crates/conjure-cp-core/src/ast/declaration.rs-413"></a><span class="w">    </span><span class="sd">/// Will block the current thread until no other thread has a write lock.</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-414" name="crates/conjure-cp-core/src/ast/declaration.rs-414"></a><span class="w">    </span><span class="sd">/// Attempting to get a read lock if the current thread already has one</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-415" name="crates/conjure-cp-core/src/ast/declaration.rs-415"></a><span class="hll"><span class="w">    </span><span class="sd">/// **will** cause it to deadlock.</span>
</span><a id="crates/conjure-cp-core/src/ast/declaration.rs-416" name="crates/conjure-cp-core/src/ast/declaration.rs-416"></a><span class="w">    </span><span class="sd">/// The lock is released when the returned guard goes out of scope.</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-417" name="crates/conjure-cp-core/src/ast/declaration.rs-417"></a><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">read</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">RwLockReadGuard</span><span class="o">&lt;&#39;</span><span class="nb">_</span><span class="p">,</span><span class="w"> </span><span class="n">Declaration</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-418" name="crates/conjure-cp-core/src/ast/declaration.rs-418"></a><span class="w">        </span><span class="bp">self</span><span class="p">.</span><span class="n">inner</span><span class="p">.</span><span class="n">value</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-419" name="crates/conjure-cp-core/src/ast/declaration.rs-419"></a><span class="w">    </span><span class="p">}</span>
</pre></div></td></tr></table></div>

            <div class="snippet"><table class="snippettable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span></pre></div></td><td class="code"><div><pre><span></span><a id="crates/conjure-cp-core/src/ast/declaration.rs-417" name="crates/conjure-cp-core/src/ast/declaration.rs-417"></a><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">read</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">RwLockReadGuard</span><span class="o">&lt;&#39;</span><span class="nb">_</span><span class="p">,</span><span class="w"> </span><span class="n">Declaration</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-418" name="crates/conjure-cp-core/src/ast/declaration.rs-418"></a><span class="w">        </span><span class="bp">self</span><span class="p">.</span><span class="n">inner</span><span class="p">.</span><span class="n">value</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-419" name="crates/conjure-cp-core/src/ast/declaration.rs-419"></a><span class="w">    </span><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-420" name="crates/conjure-cp-core/src/ast/declaration.rs-420"></a>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-421" name="crates/conjure-cp-core/src/ast/declaration.rs-421"></a><span class="hll"><span class="w">    </span><span class="sd">/// Write the underlying [Declaration].</span>
</span><a id="crates/conjure-cp-core/src/ast/declaration.rs-422" name="crates/conjure-cp-core/src/ast/declaration.rs-422"></a><span class="w">    </span><span class="sd">///</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-423" name="crates/conjure-cp-core/src/ast/declaration.rs-423"></a><span class="hll"><span class="w">    </span><span class="sd">/// Will block the current thread until no other thread has a read or write lock.</span>
</span><a id="crates/conjure-cp-core/src/ast/declaration.rs-424" name="crates/conjure-cp-core/src/ast/declaration.rs-424"></a><span class="hll"><span class="w">    </span><span class="sd">/// The lock is released when the returned guard goes out of scope.</span>
</span><a id="crates/conjure-cp-core/src/ast/declaration.rs-425" name="crates/conjure-cp-core/src/ast/declaration.rs-425"></a><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">write</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">RwLockWriteGuard</span><span class="o">&lt;&#39;</span><span class="nb">_</span><span class="p">,</span><span class="w"> </span><span class="n">Declaration</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-426" name="crates/conjure-cp-core/src/ast/declaration.rs-426"></a><span class="w">        </span><span class="bp">self</span><span class="p">.</span><span class="n">inner</span><span class="p">.</span><span class="n">value</span><span class="p">.</span><span class="n">write</span><span class="p">()</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-427" name="crates/conjure-cp-core/src/ast/declaration.rs-427"></a><span class="w">    </span><span class="p">}</span>
</pre></div></td></tr></table></div>

            <div class="snippet"><table class="snippettable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span></pre></div></td><td class="code"><div><pre><span></span><a id="crates/conjure-cp-core/src/ast/declaration.rs-469" name="crates/conjure-cp-core/src/ast/declaration.rs-469"></a><span class="w">        </span><span class="n">RwLockReadGuard</span><span class="p">::</span><span class="n">map</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">read</span><span class="p">(),</span><span class="w"> </span><span class="n">f</span><span class="p">)</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-470" name="crates/conjure-cp-core/src/ast/declaration.rs-470"></a><span class="w">    </span><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-471" name="crates/conjure-cp-core/src/ast/declaration.rs-471"></a>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-472" name="crates/conjure-cp-core/src/ast/declaration.rs-472"></a><span class="w">    </span><span class="sd">/// Applies mutable function `f` to the declaration, returning the result as a mutable reference.</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-473" name="crates/conjure-cp-core/src/ast/declaration.rs-473"></a><span class="hll"><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">map_mut</span><span class="o">&lt;</span><span class="n">U</span><span class="o">&gt;</span><span class="p">(</span>
</span><a id="crates/conjure-cp-core/src/ast/declaration.rs-474" name="crates/conjure-cp-core/src/ast/declaration.rs-474"></a><span class="hll"><span class="w">        </span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">,</span>
</span><a id="crates/conjure-cp-core/src/ast/declaration.rs-475" name="crates/conjure-cp-core/src/ast/declaration.rs-475"></a><span class="hll"><span class="w">        </span><span class="n">f</span><span class="p">:</span><span class="w"> </span><span class="nc">impl</span><span class="w"> </span><span class="nb">FnOnce</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="n">Declaration</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="kp">&amp;</span><span class="nc">mut</span><span class="w"> </span><span class="n">U</span><span class="p">,</span>
</span><a id="crates/conjure-cp-core/src/ast/declaration.rs-476" name="crates/conjure-cp-core/src/ast/declaration.rs-476"></a><span class="hll"><span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">MappedRwLockWriteGuard</span><span class="o">&lt;&#39;</span><span class="nb">_</span><span class="p">,</span><span class="w"> </span><span class="n">U</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
</span><a id="crates/conjure-cp-core/src/ast/declaration.rs-477" name="crates/conjure-cp-core/src/ast/declaration.rs-477"></a><span class="hll"><span class="w">        </span><span class="n">RwLockWriteGuard</span><span class="p">::</span><span class="n">map</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">write</span><span class="p">(),</span><span class="w"> </span><span class="n">f</span><span class="p">)</span>
</span><a id="crates/conjure-cp-core/src/ast/declaration.rs-478" name="crates/conjure-cp-core/src/ast/declaration.rs-478"></a><span class="w">    </span><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-479" name="crates/conjure-cp-core/src/ast/declaration.rs-479"></a>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-480" name="crates/conjure-cp-core/src/ast/declaration.rs-480"></a><span class="w">    </span><span class="sd">/// Replaces the declaration with a new one, returning the old value, without deinitialising</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-481" name="crates/conjure-cp-core/src/ast/declaration.rs-481"></a><span class="w">    </span><span class="sd">/// either one.</span>
</pre></div></td></tr></table></div>

            <div class="snippet"><table class="snippettable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span></pre></div></td><td class="code"><div><pre><span></span><a id="crates/conjure-cp-core/src/ast/declaration.rs-479" name="crates/conjure-cp-core/src/ast/declaration.rs-479"></a>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-480" name="crates/conjure-cp-core/src/ast/declaration.rs-480"></a><span class="w">    </span><span class="sd">/// Replaces the declaration with a new one, returning the old value, without deinitialising</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-481" name="crates/conjure-cp-core/src/ast/declaration.rs-481"></a><span class="w">    </span><span class="sd">/// either one.</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-482" name="crates/conjure-cp-core/src/ast/declaration.rs-482"></a><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">replace</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">declaration</span><span class="p">:</span><span class="w"> </span><span class="nc">Declaration</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">Declaration</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-483" name="crates/conjure-cp-core/src/ast/declaration.rs-483"></a><span class="hll"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">guard</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">write</span><span class="p">();</span>
</span><a id="crates/conjure-cp-core/src/ast/declaration.rs-484" name="crates/conjure-cp-core/src/ast/declaration.rs-484"></a><span class="hll"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">ans</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mem</span><span class="p">::</span><span class="n">replace</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="o">*</span><span class="n">guard</span><span class="p">,</span><span class="w"> </span><span class="n">declaration</span><span class="p">);</span>
</span><a id="crates/conjure-cp-core/src/ast/declaration.rs-485" name="crates/conjure-cp-core/src/ast/declaration.rs-485"></a><span class="hll"><span class="w">        </span><span class="nb">drop</span><span class="p">(</span><span class="n">guard</span><span class="p">);</span>
</span><a id="crates/conjure-cp-core/src/ast/declaration.rs-486" name="crates/conjure-cp-core/src/ast/declaration.rs-486"></a><span class="hll"><span class="w">        </span><span class="n">ans</span>
</span><a id="crates/conjure-cp-core/src/ast/declaration.rs-487" name="crates/conjure-cp-core/src/ast/declaration.rs-487"></a><span class="w">    </span><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-488" name="crates/conjure-cp-core/src/ast/declaration.rs-488"></a><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-489" name="crates/conjure-cp-core/src/ast/declaration.rs-489"></a>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-490" name="crates/conjure-cp-core/src/ast/declaration.rs-490"></a><span class="k">impl</span><span class="w"> </span><span class="n">CategoryOf</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">DeclarationPtr</span><span class="w"> </span><span class="p">{</span>
</pre></div></td></tr></table></div>

            <div class="snippet"><table class="snippettable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span></pre></div></td><td class="code"><div><pre><span></span><a id="crates/conjure-cp-core/src/ast/declaration.rs-601" name="crates/conjure-cp-core/src/ast/declaration.rs-601"></a><span class="w">            </span><span class="n">inner</span><span class="p">:</span><span class="w"> </span><span class="nc">DeclarationPtrInner</span><span class="p">::</span><span class="n">new_with_id_unchecked</span><span class="p">(</span><span class="n">RwLock</span><span class="p">::</span><span class="n">new</span><span class="p">(</span><span class="n">data</span><span class="p">),</span><span class="w"> </span><span class="n">id</span><span class="p">),</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-602" name="crates/conjure-cp-core/src/ast/declaration.rs-602"></a><span class="w">        </span><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-603" name="crates/conjure-cp-core/src/ast/declaration.rs-603"></a><span class="w">    </span><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-604" name="crates/conjure-cp-core/src/ast/declaration.rs-604"></a><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-605" name="crates/conjure-cp-core/src/ast/declaration.rs-605"></a><span class="hll">
</span><a id="crates/conjure-cp-core/src/ast/declaration.rs-606" name="crates/conjure-cp-core/src/ast/declaration.rs-606"></a><span class="k">impl</span><span class="w"> </span><span class="nb">Ord</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">DeclarationPtr</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-607" name="crates/conjure-cp-core/src/ast/declaration.rs-607"></a><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">cmp</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">other</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="nc">Self</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">std</span><span class="p">::</span><span class="n">cmp</span><span class="p">::</span><span class="n">Ordering</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-608" name="crates/conjure-cp-core/src/ast/declaration.rs-608"></a><span class="w">        </span><span class="bp">self</span><span class="p">.</span><span class="n">inner</span><span class="p">.</span><span class="n">id</span><span class="p">.</span><span class="n">cmp</span><span class="p">(</span><span class="o">&amp;</span><span class="n">other</span><span class="p">.</span><span class="n">inner</span><span class="p">.</span><span class="n">id</span><span class="p">)</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-609" name="crates/conjure-cp-core/src/ast/declaration.rs-609"></a><span class="w">    </span><span class="p">}</span>
</pre></div></td></tr></table></div>

            <div class="snippet"><table class="snippettable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span></pre></div></td><td class="code"><div><pre><span></span><a id="crates/conjure-cp-core/src/ast/declaration.rs-631" name="crates/conjure-cp-core/src/ast/declaration.rs-631"></a><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-632" name="crates/conjure-cp-core/src/ast/declaration.rs-632"></a>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-633" name="crates/conjure-cp-core/src/ast/declaration.rs-633"></a><span class="k">impl</span><span class="w"> </span><span class="n">Display</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">DeclarationPtr</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-634" name="crates/conjure-cp-core/src/ast/declaration.rs-634"></a><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">fmt</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="nc">mut</span><span class="w"> </span><span class="n">std</span><span class="p">::</span><span class="n">fmt</span><span class="p">::</span><span class="n">Formatter</span><span class="o">&lt;&#39;</span><span class="nb">_</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">std</span><span class="p">::</span><span class="n">fmt</span><span class="p">::</span><span class="nb">Result</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-635" name="crates/conjure-cp-core/src/ast/declaration.rs-635"></a><span class="hll"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">value</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="nc">Declaration</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="bp">self</span><span class="p">.</span><span class="n">read</span><span class="p">();</span>
</span><a id="crates/conjure-cp-core/src/ast/declaration.rs-636" name="crates/conjure-cp-core/src/ast/declaration.rs-636"></a><span class="w">        </span><span class="n">value</span><span class="p">.</span><span class="n">fmt</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-637" name="crates/conjure-cp-core/src/ast/declaration.rs-637"></a><span class="w">    </span><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/declaration.rs-638" name="crates/conjure-cp-core/src/ast/declaration.rs-638"></a><span class="p">}</span>
</pre></div></td></tr></table></div>

            </div>
        </div>
        <div class="src-snippet">
            <div class="src-name">crates/conjure-cp-core/src/ast/model.rs</div>
            <div class="snippets">
            <div class="snippet"><table class="snippettable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span></pre></div></td><td class="code"><div><pre><span></span><a id="crates/conjure-cp-core/src/ast/model.rs-272" name="crates/conjure-cp-core/src/ast/model.rs-272"></a><span class="w">                </span><span class="n">id_list</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">id</span><span class="p">);</span>
<a id="crates/conjure-cp-core/src/ast/model.rs-273" name="crates/conjure-cp-core/src/ast/model.rs-273"></a><span class="w">            </span><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/model.rs-274" name="crates/conjure-cp-core/src/ast/model.rs-274"></a><span class="w">        </span><span class="p">};</span>
<a id="crates/conjure-cp-core/src/ast/model.rs-275" name="crates/conjure-cp-core/src/ast/model.rs-275"></a>
<a id="crates/conjure-cp-core/src/ast/model.rs-276" name="crates/conjure-cp-core/src/ast/model.rs-276"></a><span class="hll"><span class="w">        </span><span class="c1">// Collect SymbolTable IDs by traversing all SubModels</span>
</span><a id="crates/conjure-cp-core/src/ast/model.rs-277" name="crates/conjure-cp-core/src/ast/model.rs-277"></a><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">submodel</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">submodel</span><span class="p">.</span><span class="n">universe</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/model.rs-278" name="crates/conjure-cp-core/src/ast/model.rs-278"></a><span class="w">            </span><span class="c1">// Record ID of this symbol tables</span>
<a id="crates/conjure-cp-core/src/ast/model.rs-279" name="crates/conjure-cp-core/src/ast/model.rs-279"></a><span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="n">symbol_table</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">submodel</span><span class="p">.</span><span class="n">symbols_ptr_unchecked</span><span class="p">();</span>
<a id="crates/conjure-cp-core/src/ast/model.rs-280" name="crates/conjure-cp-core/src/ast/model.rs-280"></a><span class="w">            </span><span class="n">visit</span><span class="p">(</span><span class="n">symbol_table</span><span class="p">.</span><span class="n">id</span><span class="p">());</span>
<a id="crates/conjure-cp-core/src/ast/model.rs-281" name="crates/conjure-cp-core/src/ast/model.rs-281"></a><span class="hll">
</span><a id="crates/conjure-cp-core/src/ast/model.rs-282" name="crates/conjure-cp-core/src/ast/model.rs-282"></a><span class="hll"><span class="w">            </span><span class="c1">// Collect Declaration IDs by traversing each SubModel&#39;s symbol table.</span>
</span><a id="crates/conjure-cp-core/src/ast/model.rs-283" name="crates/conjure-cp-core/src/ast/model.rs-283"></a><span class="hll"><span class="w">            </span><span class="c1">// (Assuming that all declarations in the model have to come from some symbol table!)</span>
</span><a id="crates/conjure-cp-core/src/ast/model.rs-284" name="crates/conjure-cp-core/src/ast/model.rs-284"></a><span class="w">            </span><span class="n">symbol_table</span>
<a id="crates/conjure-cp-core/src/ast/model.rs-285" name="crates/conjure-cp-core/src/ast/model.rs-285"></a><span class="w">                </span><span class="p">.</span><span class="n">read</span><span class="p">()</span>
<a id="crates/conjure-cp-core/src/ast/model.rs-286" name="crates/conjure-cp-core/src/ast/model.rs-286"></a><span class="w">                </span><span class="p">.</span><span class="n">iter_local</span><span class="p">()</span>
<a id="crates/conjure-cp-core/src/ast/model.rs-287" name="crates/conjure-cp-core/src/ast/model.rs-287"></a><span class="w">                </span><span class="p">.</span><span class="n">for_each</span><span class="p">(</span><span class="o">|</span><span class="p">(</span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">decl</span><span class="p">)</span><span class="o">|</span><span class="w"> </span><span class="n">visit</span><span class="p">(</span><span class="n">decl</span><span class="p">.</span><span class="n">id</span><span class="p">()));</span>
</pre></div></td></tr></table></div>

            <div class="snippet"><table class="snippettable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span></pre></div></td><td class="code"><div><pre><span></span><a id="crates/conjure-cp-core/src/ast/model.rs-286" name="crates/conjure-cp-core/src/ast/model.rs-286"></a><span class="w">                </span><span class="p">.</span><span class="n">iter_local</span><span class="p">()</span>
<a id="crates/conjure-cp-core/src/ast/model.rs-287" name="crates/conjure-cp-core/src/ast/model.rs-287"></a><span class="w">                </span><span class="p">.</span><span class="n">for_each</span><span class="p">(</span><span class="o">|</span><span class="p">(</span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">decl</span><span class="p">)</span><span class="o">|</span><span class="w"> </span><span class="n">visit</span><span class="p">(</span><span class="n">decl</span><span class="p">.</span><span class="n">id</span><span class="p">()));</span>
<a id="crates/conjure-cp-core/src/ast/model.rs-288" name="crates/conjure-cp-core/src/ast/model.rs-288"></a><span class="w">        </span><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/model.rs-289" name="crates/conjure-cp-core/src/ast/model.rs-289"></a>
<a id="crates/conjure-cp-core/src/ast/model.rs-290" name="crates/conjure-cp-core/src/ast/model.rs-290"></a><span class="hll"><span class="w">        </span><span class="c1">// Collect remaining IDs by traversing the expression tree</span>
</span><a id="crates/conjure-cp-core/src/ast/model.rs-291" name="crates/conjure-cp-core/src/ast/model.rs-291"></a><span class="hll"><span class="w">        </span><span class="c1">// (Some expressions, e.g. AbstractComprehensions, contain SymbolTable&#39;s not</span>
</span><a id="crates/conjure-cp-core/src/ast/model.rs-292" name="crates/conjure-cp-core/src/ast/model.rs-292"></a><span class="hll"><span class="w">        </span><span class="c1">// contained in submodels).</span>
</span><a id="crates/conjure-cp-core/src/ast/model.rs-293" name="crates/conjure-cp-core/src/ast/model.rs-293"></a><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">exprs</span><span class="p">:</span><span class="w"> </span><span class="nc">VecDeque</span><span class="o">&lt;</span><span class="n">Expression</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">submodel</span><span class="p">.</span><span class="n">universe_bi</span><span class="p">();</span>
<a id="crates/conjure-cp-core/src/ast/model.rs-294" name="crates/conjure-cp-core/src/ast/model.rs-294"></a><span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">symbol_table</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">Biplate</span><span class="p">::</span><span class="o">&lt;</span><span class="n">SymbolTablePtr</span><span class="o">&gt;</span><span class="p">::</span><span class="n">universe_bi</span><span class="p">(</span><span class="o">&amp;</span><span class="n">exprs</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/model.rs-295" name="crates/conjure-cp-core/src/ast/model.rs-295"></a><span class="w">            </span><span class="n">visit</span><span class="p">(</span><span class="n">symbol_table</span><span class="p">.</span><span class="n">id</span><span class="p">());</span>
<a id="crates/conjure-cp-core/src/ast/model.rs-296" name="crates/conjure-cp-core/src/ast/model.rs-296"></a><span class="w">            </span><span class="n">symbol_table</span>
</pre></div></td></tr></table></div>

            </div>
        </div>
        <div class="src-snippet">
            <div class="src-name">crates/conjure-cp-core/src/ast/serde.rs</div>
            <div class="snippets">
            <div class="snippet"><table class="snippettable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span></pre></div></td><td class="code"><div><pre><span></span><a id="crates/conjure-cp-core/src/ast/serde.rs-63" name="crates/conjure-cp-core/src/ast/serde.rs-63"></a>
<a id="crates/conjure-cp-core/src/ast/serde.rs-64" name="crates/conjure-cp-core/src/ast/serde.rs-64"></a><span class="sd">/// Serialises the object&#39;s ID. The actual data is **NOT stored**.</span>
<a id="crates/conjure-cp-core/src/ast/serde.rs-65" name="crates/conjure-cp-core/src/ast/serde.rs-65"></a><span class="sd">///</span>
<a id="crates/conjure-cp-core/src/ast/serde.rs-66" name="crates/conjure-cp-core/src/ast/serde.rs-66"></a><span class="sd">/// # WARNING</span>
<a id="crates/conjure-cp-core/src/ast/serde.rs-67" name="crates/conjure-cp-core/src/ast/serde.rs-67"></a><span class="hll"><span class="sd">///</span>
</span><a id="crates/conjure-cp-core/src/ast/serde.rs-68" name="crates/conjure-cp-core/src/ast/serde.rs-68"></a><span class="hll"><span class="sd">/// The object is de-serialised with the correct ID, but an empty default value.</span>
</span><a id="crates/conjure-cp-core/src/ast/serde.rs-69" name="crates/conjure-cp-core/src/ast/serde.rs-69"></a><span class="hll"><span class="sd">///</span>
</span><a id="crates/conjure-cp-core/src/ast/serde.rs-70" name="crates/conjure-cp-core/src/ast/serde.rs-70"></a><span class="sd">/// After de-serialising an entire structure, it is **the user&#39;s responsibility**</span>
<a id="crates/conjure-cp-core/src/ast/serde.rs-71" name="crates/conjure-cp-core/src/ast/serde.rs-71"></a><span class="hll"><span class="sd">/// to find a complete copy of the object and restore the shared pointer to it.</span>
</span><a id="crates/conjure-cp-core/src/ast/serde.rs-72" name="crates/conjure-cp-core/src/ast/serde.rs-72"></a><span class="hll"><span class="sd">/// This should be possible as long as at least one instance of the object has</span>
</span><a id="crates/conjure-cp-core/src/ast/serde.rs-73" name="crates/conjure-cp-core/src/ast/serde.rs-73"></a><span class="hll"><span class="sd">/// been serialised with [PtrAsInner].</span>
</span><a id="crates/conjure-cp-core/src/ast/serde.rs-74" name="crates/conjure-cp-core/src/ast/serde.rs-74"></a><span class="sd">///</span>
<a id="crates/conjure-cp-core/src/ast/serde.rs-75" name="crates/conjure-cp-core/src/ast/serde.rs-75"></a><span class="sd">/// See the de-serialisation code for [Model] for an example.</span>
<a id="crates/conjure-cp-core/src/ast/serde.rs-76" name="crates/conjure-cp-core/src/ast/serde.rs-76"></a><span class="sd">///</span>
<a id="crates/conjure-cp-core/src/ast/serde.rs-77" name="crates/conjure-cp-core/src/ast/serde.rs-77"></a><span class="k">pub</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">AsId</span><span class="p">;</span>
</pre></div></td></tr></table></div>

            <div class="snippet"><table class="snippettable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span></pre></div></td><td class="code"><div><pre><span></span><a id="crates/conjure-cp-core/src/ast/serde.rs-100" name="crates/conjure-cp-core/src/ast/serde.rs-100"></a><span class="w">        </span><span class="nb">Ok</span><span class="p">(</span><span class="n">T</span><span class="p">::</span><span class="n">default_with_id</span><span class="p">(</span><span class="n">id</span><span class="p">))</span>
<a id="crates/conjure-cp-core/src/ast/serde.rs-101" name="crates/conjure-cp-core/src/ast/serde.rs-101"></a><span class="w">    </span><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/serde.rs-102" name="crates/conjure-cp-core/src/ast/serde.rs-102"></a><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/serde.rs-103" name="crates/conjure-cp-core/src/ast/serde.rs-103"></a>
<a id="crates/conjure-cp-core/src/ast/serde.rs-104" name="crates/conjure-cp-core/src/ast/serde.rs-104"></a><span class="hll"><span class="sd">/// Serialises a shared pointer to some object `x` as a tuple `(ID, X)`, where:</span>
</span><a id="crates/conjure-cp-core/src/ast/serde.rs-105" name="crates/conjure-cp-core/src/ast/serde.rs-105"></a><span class="hll"><span class="sd">/// - `ID` is the unique and immutable ID of the object. (See: [HasId])</span>
</span><a id="crates/conjure-cp-core/src/ast/serde.rs-106" name="crates/conjure-cp-core/src/ast/serde.rs-106"></a><span class="hll"><span class="sd">/// - `X` is a full copy of the object&#39;s value.</span>
</span><a id="crates/conjure-cp-core/src/ast/serde.rs-107" name="crates/conjure-cp-core/src/ast/serde.rs-107"></a><span class="sd">///   (See `x`&#39;s implementation of the [Serialize] trait for details)</span>
<a id="crates/conjure-cp-core/src/ast/serde.rs-108" name="crates/conjure-cp-core/src/ast/serde.rs-108"></a><span class="sd">///</span>
<a id="crates/conjure-cp-core/src/ast/serde.rs-109" name="crates/conjure-cp-core/src/ast/serde.rs-109"></a><span class="hll"><span class="sd">/// On de-serialisation, **independent copies** of the object with the same ID are created.</span>
</span><a id="crates/conjure-cp-core/src/ast/serde.rs-110" name="crates/conjure-cp-core/src/ast/serde.rs-110"></a><span class="sd">///</span>
<a id="crates/conjure-cp-core/src/ast/serde.rs-111" name="crates/conjure-cp-core/src/ast/serde.rs-111"></a><span class="sd">/// # WARNING</span>
<a id="crates/conjure-cp-core/src/ast/serde.rs-112" name="crates/conjure-cp-core/src/ast/serde.rs-112"></a><span class="sd">///</span>
<a id="crates/conjure-cp-core/src/ast/serde.rs-113" name="crates/conjure-cp-core/src/ast/serde.rs-113"></a><span class="sd">/// De-serialisation makes **no attempt** to restore shared pointers.</span>
</pre></div></td></tr></table></div>

            <div class="snippet"><table class="snippettable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span></pre></div></td><td class="code"><div><pre><span></span><a id="crates/conjure-cp-core/src/ast/serde.rs-112" name="crates/conjure-cp-core/src/ast/serde.rs-112"></a><span class="sd">///</span>
<a id="crates/conjure-cp-core/src/ast/serde.rs-113" name="crates/conjure-cp-core/src/ast/serde.rs-113"></a><span class="sd">/// De-serialisation makes **no attempt** to restore shared pointers.</span>
<a id="crates/conjure-cp-core/src/ast/serde.rs-114" name="crates/conjure-cp-core/src/ast/serde.rs-114"></a><span class="sd">/// Two pointers to the same value `x` will be de-serialised as **two separate copies**</span>
<a id="crates/conjure-cp-core/src/ast/serde.rs-115" name="crates/conjure-cp-core/src/ast/serde.rs-115"></a><span class="sd">/// of it, `x&#39;` and `x&#39;&#39;`. Mutating the value of `x&#39;` will **not** change the value of `x&#39;&#39;`.</span>
<a id="crates/conjure-cp-core/src/ast/serde.rs-116" name="crates/conjure-cp-core/src/ast/serde.rs-116"></a><span class="hll"><span class="sd">///</span>
</span><a id="crates/conjure-cp-core/src/ast/serde.rs-117" name="crates/conjure-cp-core/src/ast/serde.rs-117"></a><span class="hll"><span class="sd">/// After de-serialising an entire structure, it is the user&#39;s responsibility to go through it</span>
</span><a id="crates/conjure-cp-core/src/ast/serde.rs-118" name="crates/conjure-cp-core/src/ast/serde.rs-118"></a><span class="hll"><span class="sd">/// and manually restore the shared pointers. See the de-serialisation code for [Model]</span>
</span><a id="crates/conjure-cp-core/src/ast/serde.rs-119" name="crates/conjure-cp-core/src/ast/serde.rs-119"></a><span class="sd">/// for an example.</span>
<a id="crates/conjure-cp-core/src/ast/serde.rs-120" name="crates/conjure-cp-core/src/ast/serde.rs-120"></a><span class="hll"><span class="k">pub</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">PtrAsInner</span><span class="p">;</span>
</span><a id="crates/conjure-cp-core/src/ast/serde.rs-121" name="crates/conjure-cp-core/src/ast/serde.rs-121"></a><span class="hll">
</span><a id="crates/conjure-cp-core/src/ast/serde.rs-122" name="crates/conjure-cp-core/src/ast/serde.rs-122"></a><span class="cp">#[derive(Serialize, Deserialize)]</span>
<a id="crates/conjure-cp-core/src/ast/serde.rs-123" name="crates/conjure-cp-core/src/ast/serde.rs-123"></a><span class="k">struct</span><span class="w"> </span><span class="nc">PtrAsInnerStored</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/serde.rs-124" name="crates/conjure-cp-core/src/ast/serde.rs-124"></a><span class="w">    </span><span class="n">id</span><span class="p">:</span><span class="w"> </span><span class="nc">ObjId</span><span class="p">,</span>
<a id="crates/conjure-cp-core/src/ast/serde.rs-125" name="crates/conjure-cp-core/src/ast/serde.rs-125"></a><span class="w">    </span><span class="cp">#[serde(flatten)]</span>
</pre></div></td></tr></table></div>

            <div class="snippet"><table class="snippettable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span></pre></div></td><td class="code"><div><pre><span></span><a id="crates/conjure-cp-core/src/ast/serde.rs-125" name="crates/conjure-cp-core/src/ast/serde.rs-125"></a><span class="w">    </span><span class="cp">#[serde(flatten)]</span>
<a id="crates/conjure-cp-core/src/ast/serde.rs-126" name="crates/conjure-cp-core/src/ast/serde.rs-126"></a><span class="w">    </span><span class="n">data</span><span class="p">:</span><span class="w"> </span><span class="nc">T</span><span class="p">,</span>
<a id="crates/conjure-cp-core/src/ast/serde.rs-127" name="crates/conjure-cp-core/src/ast/serde.rs-127"></a><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/serde.rs-128" name="crates/conjure-cp-core/src/ast/serde.rs-128"></a>
<a id="crates/conjure-cp-core/src/ast/serde.rs-129" name="crates/conjure-cp-core/src/ast/serde.rs-129"></a><span class="hll"><span class="k">impl</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">SerializeAs</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">PtrAsInner</span>
</span><a id="crates/conjure-cp-core/src/ast/serde.rs-130" name="crates/conjure-cp-core/src/ast/serde.rs-130"></a><span class="k">where</span>
<a id="crates/conjure-cp-core/src/ast/serde.rs-131" name="crates/conjure-cp-core/src/ast/serde.rs-131"></a><span class="w">    </span><span class="n">T</span><span class="p">:</span><span class="w"> </span><span class="nc">IdPtr</span><span class="p">,</span>
<a id="crates/conjure-cp-core/src/ast/serde.rs-132" name="crates/conjure-cp-core/src/ast/serde.rs-132"></a><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/serde.rs-133" name="crates/conjure-cp-core/src/ast/serde.rs-133"></a><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">serialize_as</span><span class="o">&lt;</span><span class="n">S</span><span class="o">&gt;</span><span class="p">(</span><span class="n">source</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="nc">T</span><span class="p">,</span><span class="w"> </span><span class="n">serializer</span><span class="p">:</span><span class="w"> </span><span class="nc">S</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nb">Result</span><span class="o">&lt;</span><span class="n">S</span><span class="p">::</span><span class="nb">Ok</span><span class="p">,</span><span class="w"> </span><span class="n">S</span><span class="p">::</span><span class="n">Error</span><span class="o">&gt;</span>
</pre></div></td></tr></table></div>

            <div class="snippet"><table class="snippettable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span></pre></div></td><td class="code"><div><pre><span></span><a id="crates/conjure-cp-core/src/ast/serde.rs-141" name="crates/conjure-cp-core/src/ast/serde.rs-141"></a><span class="w">        </span><span class="n">stored</span><span class="p">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">serializer</span><span class="p">)</span>
<a id="crates/conjure-cp-core/src/ast/serde.rs-142" name="crates/conjure-cp-core/src/ast/serde.rs-142"></a><span class="w">    </span><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/serde.rs-143" name="crates/conjure-cp-core/src/ast/serde.rs-143"></a><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/serde.rs-144" name="crates/conjure-cp-core/src/ast/serde.rs-144"></a>
<a id="crates/conjure-cp-core/src/ast/serde.rs-145" name="crates/conjure-cp-core/src/ast/serde.rs-145"></a><span class="hll"><span class="k">impl</span><span class="o">&lt;&#39;</span><span class="na">de</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">DeserializeAs</span><span class="o">&lt;&#39;</span><span class="na">de</span><span class="p">,</span><span class="w"> </span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">PtrAsInner</span>
</span><a id="crates/conjure-cp-core/src/ast/serde.rs-146" name="crates/conjure-cp-core/src/ast/serde.rs-146"></a><span class="k">where</span>
<a id="crates/conjure-cp-core/src/ast/serde.rs-147" name="crates/conjure-cp-core/src/ast/serde.rs-147"></a><span class="hll"><span class="w">    </span><span class="n">T</span><span class="p">:</span><span class="w"> </span><span class="nc">IdPtr</span><span class="p">,</span>
</span><a id="crates/conjure-cp-core/src/ast/serde.rs-148" name="crates/conjure-cp-core/src/ast/serde.rs-148"></a><span class="w">    </span><span class="n">T</span><span class="p">::</span><span class="n">Data</span><span class="p">:</span><span class="w"> </span><span class="nc">Deserialize</span><span class="o">&lt;&#39;</span><span class="na">de</span><span class="o">&gt;</span><span class="p">,</span>
<a id="crates/conjure-cp-core/src/ast/serde.rs-149" name="crates/conjure-cp-core/src/ast/serde.rs-149"></a><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/serde.rs-150" name="crates/conjure-cp-core/src/ast/serde.rs-150"></a><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">deserialize_as</span><span class="o">&lt;</span><span class="n">D</span><span class="o">&gt;</span><span class="p">(</span><span class="n">deserializer</span><span class="p">:</span><span class="w"> </span><span class="nc">D</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nb">Result</span><span class="o">&lt;</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">D</span><span class="p">::</span><span class="n">Error</span><span class="o">&gt;</span>
<a id="crates/conjure-cp-core/src/ast/serde.rs-151" name="crates/conjure-cp-core/src/ast/serde.rs-151"></a><span class="w">    </span><span class="k">where</span>
</pre></div></td></tr></table></div>

            </div>
        </div>
        <div class="src-snippet">
            <div class="src-name">crates/conjure-cp-core/src/ast/symbol_table.rs</div>
            <div class="snippets">
            <div class="snippet"><table class="snippettable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span></pre></div></td><td class="code"><div><pre><span></span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-93" name="crates/conjure-cp-core/src/ast/symbol_table.rs-93"></a><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span><span class="w"> </span><span class="nf">write</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">RwLockWriteGuard</span><span class="o">&lt;&#39;</span><span class="nb">_</span><span class="p">,</span><span class="w"> </span><span class="n">SymbolTable</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-94" name="crates/conjure-cp-core/src/ast/symbol_table.rs-94"></a><span class="w">        </span><span class="bp">self</span><span class="p">.</span><span class="n">inner</span><span class="p">.</span><span class="n">value</span><span class="p">.</span><span class="n">write</span><span class="p">()</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-95" name="crates/conjure-cp-core/src/ast/symbol_table.rs-95"></a><span class="w">    </span><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-96" name="crates/conjure-cp-core/src/ast/symbol_table.rs-96"></a>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-97" name="crates/conjure-cp-core/src/ast/symbol_table.rs-97"></a><span class="hll"><span class="w">    </span><span class="sd">/// Create a new symbol table with the same contents as this one, but a new ID,</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-98" name="crates/conjure-cp-core/src/ast/symbol_table.rs-98"></a><span class="hll"><span class="w">    </span><span class="sd">/// and return a pointer to it.</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-99" name="crates/conjure-cp-core/src/ast/symbol_table.rs-99"></a><span class="hll"><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span><span class="w"> </span><span class="nf">detach</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">Self</span><span class="w"> </span><span class="p">{</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-100" name="crates/conjure-cp-core/src/ast/symbol_table.rs-100"></a><span class="hll"><span class="w">        </span><span class="bp">Self</span><span class="p">::</span><span class="n">new_with_data</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">read</span><span class="p">().</span><span class="n">clone</span><span class="p">())</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-101" name="crates/conjure-cp-core/src/ast/symbol_table.rs-101"></a><span class="hll"><span class="w">    </span><span class="p">}</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-102" name="crates/conjure-cp-core/src/ast/symbol_table.rs-102"></a><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-103" name="crates/conjure-cp-core/src/ast/symbol_table.rs-103"></a>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-104" name="crates/conjure-cp-core/src/ast/symbol_table.rs-104"></a><span class="hll"><span class="k">impl</span><span class="w"> </span><span class="nb">Default</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">SymbolTablePtr</span><span class="w"> </span><span class="p">{</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-105" name="crates/conjure-cp-core/src/ast/symbol_table.rs-105"></a><span class="hll"><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">default</span><span class="p">()</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">Self</span><span class="w"> </span><span class="p">{</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-106" name="crates/conjure-cp-core/src/ast/symbol_table.rs-106"></a><span class="hll"><span class="w">        </span><span class="bp">Self</span><span class="p">::</span><span class="n">new</span><span class="p">()</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-107" name="crates/conjure-cp-core/src/ast/symbol_table.rs-107"></a><span class="hll"><span class="w">    </span><span class="p">}</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-108" name="crates/conjure-cp-core/src/ast/symbol_table.rs-108"></a><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-109" name="crates/conjure-cp-core/src/ast/symbol_table.rs-109"></a><span class="hll">
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-110" name="crates/conjure-cp-core/src/ast/symbol_table.rs-110"></a><span class="hll"><span class="k">impl</span><span class="w"> </span><span class="n">HasId</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">SymbolTablePtr</span><span class="w"> </span><span class="p">{</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-111" name="crates/conjure-cp-core/src/ast/symbol_table.rs-111"></a><span class="hll"><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">TYPE_NAME</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="o">&#39;</span><span class="nb">static</span><span class="w"> </span><span class="kt">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;SymbolTable&quot;</span><span class="p">;</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-112" name="crates/conjure-cp-core/src/ast/symbol_table.rs-112"></a>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-113" name="crates/conjure-cp-core/src/ast/symbol_table.rs-113"></a><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">ObjId</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-114" name="crates/conjure-cp-core/src/ast/symbol_table.rs-114"></a><span class="w">        </span><span class="bp">self</span><span class="p">.</span><span class="n">inner</span><span class="p">.</span><span class="n">id</span><span class="p">.</span><span class="n">clone</span><span class="p">()</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-115" name="crates/conjure-cp-core/src/ast/symbol_table.rs-115"></a><span class="w">    </span><span class="p">}</span>
</pre></div></td></tr></table></div>

            <div class="snippet"><table class="snippettable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span></pre></div></td><td class="code"><div><pre><span></span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-113" name="crates/conjure-cp-core/src/ast/symbol_table.rs-113"></a><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">id</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">ObjId</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-114" name="crates/conjure-cp-core/src/ast/symbol_table.rs-114"></a><span class="w">        </span><span class="bp">self</span><span class="p">.</span><span class="n">inner</span><span class="p">.</span><span class="n">id</span><span class="p">.</span><span class="n">clone</span><span class="p">()</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-115" name="crates/conjure-cp-core/src/ast/symbol_table.rs-115"></a><span class="w">    </span><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-116" name="crates/conjure-cp-core/src/ast/symbol_table.rs-116"></a><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-117" name="crates/conjure-cp-core/src/ast/symbol_table.rs-117"></a><span class="hll">
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-118" name="crates/conjure-cp-core/src/ast/symbol_table.rs-118"></a><span class="hll"><span class="k">impl</span><span class="w"> </span><span class="n">DefaultWithId</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">SymbolTablePtr</span><span class="w"> </span><span class="p">{</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-119" name="crates/conjure-cp-core/src/ast/symbol_table.rs-119"></a><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">default_with_id</span><span class="p">(</span><span class="n">id</span><span class="p">:</span><span class="w"> </span><span class="nc">ObjId</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">Self</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-120" name="crates/conjure-cp-core/src/ast/symbol_table.rs-120"></a><span class="w">        </span><span class="bp">Self</span><span class="p">::</span><span class="n">new_with_id_and_data</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">SymbolTable</span><span class="p">::</span><span class="n">default</span><span class="p">())</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-121" name="crates/conjure-cp-core/src/ast/symbol_table.rs-121"></a><span class="w">    </span><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-122" name="crates/conjure-cp-core/src/ast/symbol_table.rs-122"></a><span class="p">}</span>
</pre></div></td></tr></table></div>

            <div class="snippet"><table class="snippettable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span></pre></div></td><td class="code"><div><pre><span></span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-120" name="crates/conjure-cp-core/src/ast/symbol_table.rs-120"></a><span class="w">        </span><span class="bp">Self</span><span class="p">::</span><span class="n">new_with_id_and_data</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">SymbolTable</span><span class="p">::</span><span class="n">default</span><span class="p">())</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-121" name="crates/conjure-cp-core/src/ast/symbol_table.rs-121"></a><span class="w">    </span><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-122" name="crates/conjure-cp-core/src/ast/symbol_table.rs-122"></a><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-123" name="crates/conjure-cp-core/src/ast/symbol_table.rs-123"></a>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-124" name="crates/conjure-cp-core/src/ast/symbol_table.rs-124"></a><span class="hll"><span class="k">impl</span><span class="w"> </span><span class="n">IdPtr</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">SymbolTablePtr</span><span class="w"> </span><span class="p">{</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-125" name="crates/conjure-cp-core/src/ast/symbol_table.rs-125"></a><span class="hll"><span class="w">    </span><span class="k">type</span><span class="w"> </span><span class="nc">Data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SymbolTable</span><span class="p">;</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-126" name="crates/conjure-cp-core/src/ast/symbol_table.rs-126"></a><span class="hll">
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-127" name="crates/conjure-cp-core/src/ast/symbol_table.rs-127"></a><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">get_data</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">Self</span><span class="p">::</span><span class="n">Data</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-128" name="crates/conjure-cp-core/src/ast/symbol_table.rs-128"></a><span class="w">        </span><span class="bp">self</span><span class="p">.</span><span class="n">read</span><span class="p">().</span><span class="n">clone</span><span class="p">()</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-129" name="crates/conjure-cp-core/src/ast/symbol_table.rs-129"></a><span class="w">    </span><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-130" name="crates/conjure-cp-core/src/ast/symbol_table.rs-130"></a><span class="hll">
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-131" name="crates/conjure-cp-core/src/ast/symbol_table.rs-131"></a><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">with_id_and_data</span><span class="p">(</span><span class="n">id</span><span class="p">:</span><span class="w"> </span><span class="nc">ObjId</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">:</span><span class="w"> </span><span class="nc">Self</span><span class="p">::</span><span class="n">Data</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">Self</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-132" name="crates/conjure-cp-core/src/ast/symbol_table.rs-132"></a><span class="w">        </span><span class="bp">Self</span><span class="p">::</span><span class="n">new_with_id_and_data</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">)</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-133" name="crates/conjure-cp-core/src/ast/symbol_table.rs-133"></a><span class="w">    </span><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-134" name="crates/conjure-cp-core/src/ast/symbol_table.rs-134"></a><span class="p">}</span>
</pre></div></td></tr></table></div>

            <div class="snippet"><table class="snippettable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span></pre></div></td><td class="code"><div><pre><span></span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-132" name="crates/conjure-cp-core/src/ast/symbol_table.rs-132"></a><span class="w">        </span><span class="bp">Self</span><span class="p">::</span><span class="n">new_with_id_and_data</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="p">)</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-133" name="crates/conjure-cp-core/src/ast/symbol_table.rs-133"></a><span class="w">    </span><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-134" name="crates/conjure-cp-core/src/ast/symbol_table.rs-134"></a><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-135" name="crates/conjure-cp-core/src/ast/symbol_table.rs-135"></a>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-136" name="crates/conjure-cp-core/src/ast/symbol_table.rs-136"></a><span class="hll"><span class="c1">// TODO: this code is almost exactly copied from [DeclarationPtr].</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-137" name="crates/conjure-cp-core/src/ast/symbol_table.rs-137"></a><span class="hll"><span class="c1">//       It should be possible to eliminate the duplication...</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-138" name="crates/conjure-cp-core/src/ast/symbol_table.rs-138"></a><span class="hll"><span class="c1">//       Perhaps by merging SymbolTablePtr and DeclarationPtr together?</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-139" name="crates/conjure-cp-core/src/ast/symbol_table.rs-139"></a><span class="c1">//       (Alternatively, a macro?)</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-140" name="crates/conjure-cp-core/src/ast/symbol_table.rs-140"></a>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-141" name="crates/conjure-cp-core/src/ast/symbol_table.rs-141"></a><span class="k">impl</span><span class="w"> </span><span class="n">Uniplate</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">SymbolTablePtr</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-142" name="crates/conjure-cp-core/src/ast/symbol_table.rs-142"></a><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">uniplate</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">Tree</span><span class="o">&lt;</span><span class="bp">Self</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="nb">Box</span><span class="o">&lt;</span><span class="k">dyn</span><span class="w"> </span><span class="nb">Fn</span><span class="p">(</span><span class="n">Tree</span><span class="o">&lt;</span><span class="bp">Self</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">Self</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</pre></div></td></tr></table></div>

            <div class="snippet"><table class="snippettable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span></pre></div></td><td class="code"><div><pre><span></span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-141" name="crates/conjure-cp-core/src/ast/symbol_table.rs-141"></a><span class="k">impl</span><span class="w"> </span><span class="n">Uniplate</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">SymbolTablePtr</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-142" name="crates/conjure-cp-core/src/ast/symbol_table.rs-142"></a><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">uniplate</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">Tree</span><span class="o">&lt;</span><span class="bp">Self</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="nb">Box</span><span class="o">&lt;</span><span class="k">dyn</span><span class="w"> </span><span class="nb">Fn</span><span class="p">(</span><span class="n">Tree</span><span class="o">&lt;</span><span class="bp">Self</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">Self</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-143" name="crates/conjure-cp-core/src/ast/symbol_table.rs-143"></a><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">symtab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">read</span><span class="p">();</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-144" name="crates/conjure-cp-core/src/ast/symbol_table.rs-144"></a><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">tree</span><span class="p">,</span><span class="w"> </span><span class="n">recons</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Biplate</span><span class="p">::</span><span class="o">&lt;</span><span class="n">SymbolTablePtr</span><span class="o">&gt;</span><span class="p">::</span><span class="n">biplate</span><span class="p">(</span><span class="o">&amp;</span><span class="n">symtab</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="o">&amp;</span><span class="n">SymbolTable</span><span class="p">);</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-145" name="crates/conjure-cp-core/src/ast/symbol_table.rs-145"></a><span class="hll">
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-146" name="crates/conjure-cp-core/src/ast/symbol_table.rs-146"></a><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">self2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">clone</span><span class="p">();</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-147" name="crates/conjure-cp-core/src/ast/symbol_table.rs-147"></a><span class="hll"><span class="w">        </span><span class="p">(</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-148" name="crates/conjure-cp-core/src/ast/symbol_table.rs-148"></a><span class="w">            </span><span class="n">tree</span><span class="p">,</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-149" name="crates/conjure-cp-core/src/ast/symbol_table.rs-149"></a><span class="w">            </span><span class="nb">Box</span><span class="p">::</span><span class="n">new</span><span class="p">(</span><span class="k">move</span><span class="w"> </span><span class="o">|</span><span class="n">x</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-150" name="crates/conjure-cp-core/src/ast/symbol_table.rs-150"></a><span class="hll"><span class="w">                </span><span class="kd">let</span><span class="w"> </span><span class="n">self3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self2</span><span class="p">.</span><span class="n">clone</span><span class="p">();</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-151" name="crates/conjure-cp-core/src/ast/symbol_table.rs-151"></a><span class="hll"><span class="w">                </span><span class="o">*</span><span class="p">(</span><span class="n">self3</span><span class="p">.</span><span class="n">write</span><span class="p">())</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">recons</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-152" name="crates/conjure-cp-core/src/ast/symbol_table.rs-152"></a><span class="hll"><span class="w">                </span><span class="n">self3</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-153" name="crates/conjure-cp-core/src/ast/symbol_table.rs-153"></a><span class="hll"><span class="w">            </span><span class="p">}),</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-154" name="crates/conjure-cp-core/src/ast/symbol_table.rs-154"></a><span class="hll"><span class="w">        </span><span class="p">)</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-155" name="crates/conjure-cp-core/src/ast/symbol_table.rs-155"></a><span class="w">    </span><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-156" name="crates/conjure-cp-core/src/ast/symbol_table.rs-156"></a><span class="hll"><span class="p">}</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-157" name="crates/conjure-cp-core/src/ast/symbol_table.rs-157"></a><span class="hll">
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-158" name="crates/conjure-cp-core/src/ast/symbol_table.rs-158"></a><span class="hll"><span class="k">impl</span><span class="o">&lt;</span><span class="n">To</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Biplate</span><span class="o">&lt;</span><span class="n">To</span><span class="o">&gt;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">SymbolTablePtr</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-159" name="crates/conjure-cp-core/src/ast/symbol_table.rs-159"></a><span class="k">where</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-160" name="crates/conjure-cp-core/src/ast/symbol_table.rs-160"></a><span class="hll"><span class="w">    </span><span class="n">SymbolTable</span><span class="p">:</span><span class="w"> </span><span class="nc">Biplate</span><span class="o">&lt;</span><span class="n">To</span><span class="o">&gt;</span><span class="p">,</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-161" name="crates/conjure-cp-core/src/ast/symbol_table.rs-161"></a><span class="w">    </span><span class="n">To</span><span class="p">:</span><span class="w"> </span><span class="nc">Uniplate</span><span class="p">,</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-162" name="crates/conjure-cp-core/src/ast/symbol_table.rs-162"></a><span class="hll"><span class="p">{</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-163" name="crates/conjure-cp-core/src/ast/symbol_table.rs-163"></a><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">biplate</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">Tree</span><span class="o">&lt;</span><span class="n">To</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="nb">Box</span><span class="o">&lt;</span><span class="k">dyn</span><span class="w"> </span><span class="nb">Fn</span><span class="p">(</span><span class="n">Tree</span><span class="o">&lt;</span><span class="n">To</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">Self</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-164" name="crates/conjure-cp-core/src/ast/symbol_table.rs-164"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">TypeId</span><span class="p">::</span><span class="n">of</span><span class="p">::</span><span class="o">&lt;</span><span class="n">To</span><span class="o">&gt;</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">TypeId</span><span class="p">::</span><span class="n">of</span><span class="p">::</span><span class="o">&lt;</span><span class="bp">Self</span><span class="o">&gt;</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-165" name="crates/conjure-cp-core/src/ast/symbol_table.rs-165"></a><span class="hll"><span class="w">            </span><span class="k">unsafe</span><span class="w"> </span><span class="p">{</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-166" name="crates/conjure-cp-core/src/ast/symbol_table.rs-166"></a><span class="w">                </span><span class="kd">let</span><span class="w"> </span><span class="n">self_as_to</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="p">::</span><span class="n">mem</span><span class="p">::</span><span class="n">transmute</span><span class="p">::</span><span class="o">&lt;&amp;</span><span class="bp">Self</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">To</span><span class="o">&gt;</span><span class="p">(</span><span class="bp">self</span><span class="p">).</span><span class="n">clone</span><span class="p">();</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-167" name="crates/conjure-cp-core/src/ast/symbol_table.rs-167"></a><span class="hll"><span class="w">                </span><span class="p">(</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-168" name="crates/conjure-cp-core/src/ast/symbol_table.rs-168"></a><span class="w">                    </span><span class="n">Tree</span><span class="p">::</span><span class="n">One</span><span class="p">(</span><span class="n">self_as_to</span><span class="p">),</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-169" name="crates/conjure-cp-core/src/ast/symbol_table.rs-169"></a><span class="w">                    </span><span class="nb">Box</span><span class="p">::</span><span class="n">new</span><span class="p">(</span><span class="k">move</span><span class="w"> </span><span class="o">|</span><span class="n">x</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-170" name="crates/conjure-cp-core/src/ast/symbol_table.rs-170"></a><span class="hll"><span class="w">                        </span><span class="kd">let</span><span class="w"> </span><span class="n">Tree</span><span class="p">::</span><span class="n">One</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="fm">panic!</span><span class="p">()</span><span class="w"> </span><span class="p">};</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-171" name="crates/conjure-cp-core/src/ast/symbol_table.rs-171"></a><span class="hll">
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-172" name="crates/conjure-cp-core/src/ast/symbol_table.rs-172"></a><span class="hll"><span class="w">                        </span><span class="kd">let</span><span class="w"> </span><span class="n">x_as_self</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="p">::</span><span class="n">mem</span><span class="p">::</span><span class="n">transmute</span><span class="p">::</span><span class="o">&lt;&amp;</span><span class="n">To</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="bp">Self</span><span class="o">&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">x</span><span class="p">);</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-173" name="crates/conjure-cp-core/src/ast/symbol_table.rs-173"></a><span class="hll"><span class="w">                        </span><span class="n">x_as_self</span><span class="p">.</span><span class="n">clone</span><span class="p">()</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-174" name="crates/conjure-cp-core/src/ast/symbol_table.rs-174"></a><span class="hll"><span class="w">                    </span><span class="p">}),</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-175" name="crates/conjure-cp-core/src/ast/symbol_table.rs-175"></a><span class="w">                </span><span class="p">)</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-176" name="crates/conjure-cp-core/src/ast/symbol_table.rs-176"></a><span class="hll"><span class="w">            </span><span class="p">}</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-177" name="crates/conjure-cp-core/src/ast/symbol_table.rs-177"></a><span class="hll"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-178" name="crates/conjure-cp-core/src/ast/symbol_table.rs-178"></a><span class="hll"><span class="w">            </span><span class="c1">// call biplate on the enclosed declaration</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-179" name="crates/conjure-cp-core/src/ast/symbol_table.rs-179"></a><span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="n">decl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">read</span><span class="p">();</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-180" name="crates/conjure-cp-core/src/ast/symbol_table.rs-180"></a><span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="p">(</span><span class="n">tree</span><span class="p">,</span><span class="w"> </span><span class="n">recons</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Biplate</span><span class="p">::</span><span class="o">&lt;</span><span class="n">To</span><span class="o">&gt;</span><span class="p">::</span><span class="n">biplate</span><span class="p">(</span><span class="o">&amp;</span><span class="n">decl</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="o">&amp;</span><span class="n">SymbolTable</span><span class="p">);</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-181" name="crates/conjure-cp-core/src/ast/symbol_table.rs-181"></a>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-182" name="crates/conjure-cp-core/src/ast/symbol_table.rs-182"></a><span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="n">self2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">clone</span><span class="p">();</span>
</pre></div></td></tr></table></div>

            <div class="snippet"><table class="snippettable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span></pre></div></td><td class="code"><div><pre><span></span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-182" name="crates/conjure-cp-core/src/ast/symbol_table.rs-182"></a><span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="n">self2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">clone</span><span class="p">();</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-183" name="crates/conjure-cp-core/src/ast/symbol_table.rs-183"></a><span class="w">            </span><span class="p">(</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-184" name="crates/conjure-cp-core/src/ast/symbol_table.rs-184"></a><span class="w">                </span><span class="n">tree</span><span class="p">,</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-185" name="crates/conjure-cp-core/src/ast/symbol_table.rs-185"></a><span class="w">                </span><span class="nb">Box</span><span class="p">::</span><span class="n">new</span><span class="p">(</span><span class="k">move</span><span class="w"> </span><span class="o">|</span><span class="n">x</span><span class="o">|</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-186" name="crates/conjure-cp-core/src/ast/symbol_table.rs-186"></a><span class="hll"><span class="w">                    </span><span class="kd">let</span><span class="w"> </span><span class="n">self3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self2</span><span class="p">.</span><span class="n">clone</span><span class="p">();</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-187" name="crates/conjure-cp-core/src/ast/symbol_table.rs-187"></a><span class="hll"><span class="w">                    </span><span class="o">*</span><span class="p">(</span><span class="n">self3</span><span class="p">.</span><span class="n">write</span><span class="p">())</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">recons</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-188" name="crates/conjure-cp-core/src/ast/symbol_table.rs-188"></a><span class="hll"><span class="w">                    </span><span class="n">self3</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-189" name="crates/conjure-cp-core/src/ast/symbol_table.rs-189"></a><span class="hll"><span class="w">                </span><span class="p">}),</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-190" name="crates/conjure-cp-core/src/ast/symbol_table.rs-190"></a><span class="hll"><span class="w">            </span><span class="p">)</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-191" name="crates/conjure-cp-core/src/ast/symbol_table.rs-191"></a><span class="w">        </span><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-192" name="crates/conjure-cp-core/src/ast/symbol_table.rs-192"></a><span class="w">    </span><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-193" name="crates/conjure-cp-core/src/ast/symbol_table.rs-193"></a><span class="p">}</span>
</pre></div></td></tr></table></div>

            <div class="snippet"><table class="snippettable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span></pre></div></td><td class="code"><div><pre><span></span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-192" name="crates/conjure-cp-core/src/ast/symbol_table.rs-192"></a><span class="w">    </span><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-193" name="crates/conjure-cp-core/src/ast/symbol_table.rs-193"></a><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-194" name="crates/conjure-cp-core/src/ast/symbol_table.rs-194"></a>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-195" name="crates/conjure-cp-core/src/ast/symbol_table.rs-195"></a><span class="cp">#[derive(Debug)]</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-196" name="crates/conjure-cp-core/src/ast/symbol_table.rs-196"></a><span class="hll"><span class="k">struct</span><span class="w"> </span><span class="nc">SymbolTablePtrInner</span><span class="w"> </span><span class="p">{</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-197" name="crates/conjure-cp-core/src/ast/symbol_table.rs-197"></a><span class="hll"><span class="w">    </span><span class="n">id</span><span class="p">:</span><span class="w"> </span><span class="nc">ObjId</span><span class="p">,</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-198" name="crates/conjure-cp-core/src/ast/symbol_table.rs-198"></a><span class="w">    </span><span class="n">value</span><span class="p">:</span><span class="w"> </span><span class="nc">RwLock</span><span class="o">&lt;</span><span class="n">SymbolTable</span><span class="o">&gt;</span><span class="p">,</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-199" name="crates/conjure-cp-core/src/ast/symbol_table.rs-199"></a><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-200" name="crates/conjure-cp-core/src/ast/symbol_table.rs-200"></a><span class="hll">
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-201" name="crates/conjure-cp-core/src/ast/symbol_table.rs-201"></a><span class="hll"><span class="k">impl</span><span class="w"> </span><span class="n">Hash</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">SymbolTablePtrInner</span><span class="w"> </span><span class="p">{</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-202" name="crates/conjure-cp-core/src/ast/symbol_table.rs-202"></a><span class="hll"><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">hash</span><span class="o">&lt;</span><span class="n">H</span><span class="p">:</span><span class="w"> </span><span class="nc">Hasher</span><span class="o">&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">state</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="nc">mut</span><span class="w"> </span><span class="n">H</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-203" name="crates/conjure-cp-core/src/ast/symbol_table.rs-203"></a><span class="hll"><span class="w">        </span><span class="bp">self</span><span class="p">.</span><span class="n">id</span><span class="p">.</span><span class="n">hash</span><span class="p">(</span><span class="n">state</span><span class="p">);</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-204" name="crates/conjure-cp-core/src/ast/symbol_table.rs-204"></a><span class="hll"><span class="w">    </span><span class="p">}</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-205" name="crates/conjure-cp-core/src/ast/symbol_table.rs-205"></a><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-206" name="crates/conjure-cp-core/src/ast/symbol_table.rs-206"></a>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-207" name="crates/conjure-cp-core/src/ast/symbol_table.rs-207"></a><span class="k">impl</span><span class="w"> </span><span class="nb">PartialEq</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">SymbolTablePtrInner</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-208" name="crates/conjure-cp-core/src/ast/symbol_table.rs-208"></a><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">eq</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">other</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="nc">Self</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="p">{</span>
</pre></div></td></tr></table></div>

            <div class="snippet"><table class="snippettable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span></pre></div></td><td class="code"><div><pre><span></span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-207" name="crates/conjure-cp-core/src/ast/symbol_table.rs-207"></a><span class="k">impl</span><span class="w"> </span><span class="nb">PartialEq</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">SymbolTablePtrInner</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-208" name="crates/conjure-cp-core/src/ast/symbol_table.rs-208"></a><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">eq</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">other</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="nc">Self</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-209" name="crates/conjure-cp-core/src/ast/symbol_table.rs-209"></a><span class="w">        </span><span class="bp">self</span><span class="p">.</span><span class="n">value</span><span class="p">.</span><span class="n">read</span><span class="p">().</span><span class="n">eq</span><span class="p">(</span><span class="o">&amp;</span><span class="n">other</span><span class="p">.</span><span class="n">value</span><span class="p">.</span><span class="n">read</span><span class="p">())</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-210" name="crates/conjure-cp-core/src/ast/symbol_table.rs-210"></a><span class="w">    </span><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-211" name="crates/conjure-cp-core/src/ast/symbol_table.rs-211"></a><span class="hll"><span class="p">}</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-212" name="crates/conjure-cp-core/src/ast/symbol_table.rs-212"></a>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-213" name="crates/conjure-cp-core/src/ast/symbol_table.rs-213"></a><span class="hll"><span class="k">impl</span><span class="w"> </span><span class="nb">Eq</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">SymbolTablePtrInner</span><span class="w"> </span><span class="p">{}</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-214" name="crates/conjure-cp-core/src/ast/symbol_table.rs-214"></a><span class="hll">
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-215" name="crates/conjure-cp-core/src/ast/symbol_table.rs-215"></a><span class="sd">/// The global symbol table, mapping names to their definitions.</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-216" name="crates/conjure-cp-core/src/ast/symbol_table.rs-216"></a><span class="sd">///</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-217" name="crates/conjure-cp-core/src/ast/symbol_table.rs-217"></a><span class="sd">/// Names in the symbol table are unique, including between different types of object stored in the</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-218" name="crates/conjure-cp-core/src/ast/symbol_table.rs-218"></a><span class="sd">/// symbol table. For example, you cannot have a letting and decision variable with the same name.</span>
</pre></div></td></tr></table></div>

            <div class="snippet"><table class="snippettable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span></pre></div></td><td class="code"><div><pre><span></span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-248" name="crates/conjure-cp-core/src/ast/symbol_table.rs-248"></a><span class="sd">/// Row manual (version 1.9.1 at time of writing).</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-249" name="crates/conjure-cp-core/src/ast/symbol_table.rs-249"></a><span class="cp">#[serde_as]</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-250" name="crates/conjure-cp-core/src/ast/symbol_table.rs-250"></a><span class="cp">#[derive(Debug, PartialEq, Eq, Clone, Serialize, Deserialize)]</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-251" name="crates/conjure-cp-core/src/ast/symbol_table.rs-251"></a><span class="k">pub</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">SymbolTable</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-252" name="crates/conjure-cp-core/src/ast/symbol_table.rs-252"></a><span class="hll"><span class="w">    </span><span class="cp">#[serde_as(as = </span><span class="s">&quot;Vec&lt;(_,PtrAsInner)&gt;&quot;</span><span class="cp">)]</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-253" name="crates/conjure-cp-core/src/ast/symbol_table.rs-253"></a><span class="w">    </span><span class="n">table</span><span class="p">:</span><span class="w"> </span><span class="nc">BTreeMap</span><span class="o">&lt;</span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">DeclarationPtr</span><span class="o">&gt;</span><span class="p">,</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-254" name="crates/conjure-cp-core/src/ast/symbol_table.rs-254"></a>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-255" name="crates/conjure-cp-core/src/ast/symbol_table.rs-255"></a><span class="w">    </span><span class="cp">#[serde_as(as = </span><span class="s">&quot;Option&lt;AsId&gt;&quot;</span><span class="cp">)]</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-256" name="crates/conjure-cp-core/src/ast/symbol_table.rs-256"></a><span class="w">    </span><span class="n">parent</span><span class="p">:</span><span class="w"> </span><span class="nb">Option</span><span class="o">&lt;</span><span class="n">SymbolTablePtr</span><span class="o">&gt;</span><span class="p">,</span>
</pre></div></td></tr></table></div>

            <div class="snippet"><table class="snippettable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span></pre></div></td><td class="code"><div><pre><span></span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-350" name="crates/conjure-cp-core/src/ast/symbol_table.rs-350"></a><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span><span class="w"> </span><span class="nf">resolve_domain</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="nc">Name</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nb">Option</span><span class="o">&lt;</span><span class="n">Moo</span><span class="o">&lt;</span><span class="n">GroundDomain</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-351" name="crates/conjure-cp-core/src/ast/symbol_table.rs-351"></a><span class="w">        </span><span class="bp">self</span><span class="p">.</span><span class="n">domain</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">?</span><span class="p">.</span><span class="n">resolve</span><span class="p">()</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-352" name="crates/conjure-cp-core/src/ast/symbol_table.rs-352"></a><span class="w">    </span><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-353" name="crates/conjure-cp-core/src/ast/symbol_table.rs-353"></a>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-354" name="crates/conjure-cp-core/src/ast/symbol_table.rs-354"></a><span class="hll"><span class="w">    </span><span class="sd">/// Iterates over entries in the LOCAL symbol table.</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-355" name="crates/conjure-cp-core/src/ast/symbol_table.rs-355"></a><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span><span class="w"> </span><span class="nf">into_iter_local</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">impl</span><span class="w"> </span><span class="nb">Iterator</span><span class="o">&lt;</span><span class="n">Item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">DeclarationPtr</span><span class="p">)</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-356" name="crates/conjure-cp-core/src/ast/symbol_table.rs-356"></a><span class="w">        </span><span class="bp">self</span><span class="p">.</span><span class="n">table</span><span class="p">.</span><span class="n">into_iter</span><span class="p">()</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-357" name="crates/conjure-cp-core/src/ast/symbol_table.rs-357"></a><span class="w">    </span><span class="p">}</span>
</pre></div></td></tr></table></div>

            <div class="snippet"><table class="snippettable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span></pre></div></td><td class="code"><div><pre><span></span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-401" name="crates/conjure-cp-core/src/ast/symbol_table.rs-401"></a><span class="w">    </span><span class="sd">/// Gets the parent of this symbol table.</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-402" name="crates/conjure-cp-core/src/ast/symbol_table.rs-402"></a><span class="w">    </span><span class="k">pub</span><span class="w"> </span><span class="k">fn</span><span class="w"> </span><span class="nf">parent</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="kp">&amp;</span><span class="nb">Option</span><span class="o">&lt;</span><span class="n">SymbolTablePtr</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-403" name="crates/conjure-cp-core/src/ast/symbol_table.rs-403"></a><span class="w">        </span><span class="o">&amp;</span><span class="bp">self</span><span class="p">.</span><span class="n">parent</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-404" name="crates/conjure-cp-core/src/ast/symbol_table.rs-404"></a><span class="w">    </span><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-405" name="crates/conjure-cp-core/src/ast/symbol_table.rs-405"></a><span class="hll">
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-406" name="crates/conjure-cp-core/src/ast/symbol_table.rs-406"></a><span class="w">    </span><span class="sd">/// Gets the representation `representation` for `name`.</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-407" name="crates/conjure-cp-core/src/ast/symbol_table.rs-407"></a><span class="w">    </span><span class="sd">///</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-408" name="crates/conjure-cp-core/src/ast/symbol_table.rs-408"></a><span class="w">    </span><span class="sd">/// # Returns</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-409" name="crates/conjure-cp-core/src/ast/symbol_table.rs-409"></a><span class="w">    </span><span class="sd">///</span>
</pre></div></td></tr></table></div>

            <div class="snippet"><table class="snippettable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span></pre></div></td><td class="code"><div><pre><span></span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-506" name="crates/conjure-cp-core/src/ast/symbol_table.rs-506"></a>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-507" name="crates/conjure-cp-core/src/ast/symbol_table.rs-507"></a><span class="k">impl</span><span class="w"> </span><span class="nb">IntoIterator</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">SymbolTable</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-508" name="crates/conjure-cp-core/src/ast/symbol_table.rs-508"></a><span class="w">    </span><span class="k">type</span><span class="w"> </span><span class="nc">Item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">DeclarationPtr</span><span class="p">);</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-509" name="crates/conjure-cp-core/src/ast/symbol_table.rs-509"></a>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-510" name="crates/conjure-cp-core/src/ast/symbol_table.rs-510"></a><span class="hll"><span class="w">    </span><span class="k">type</span><span class="w"> </span><span class="nc">IntoIter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SymbolTableIter</span><span class="p">;</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-511" name="crates/conjure-cp-core/src/ast/symbol_table.rs-511"></a>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-512" name="crates/conjure-cp-core/src/ast/symbol_table.rs-512"></a><span class="w">    </span><span class="sd">/// Iterates over symbol table entries in scope.</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-513" name="crates/conjure-cp-core/src/ast/symbol_table.rs-513"></a><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">into_iter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">Self</span><span class="p">::</span><span class="n">IntoIter</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-514" name="crates/conjure-cp-core/src/ast/symbol_table.rs-514"></a><span class="w">        </span><span class="n">SymbolTableIter</span><span class="w"> </span><span class="p">{</span>
</pre></div></td></tr></table></div>

            <div class="snippet"><table class="snippettable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span></pre></div></td><td class="code"><div><pre><span></span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-526" name="crates/conjure-cp-core/src/ast/symbol_table.rs-526"></a><span class="w">    </span><span class="c1">// the parent scope</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-527" name="crates/conjure-cp-core/src/ast/symbol_table.rs-527"></a><span class="w">    </span><span class="n">parent</span><span class="p">:</span><span class="w"> </span><span class="nb">Option</span><span class="o">&lt;</span><span class="n">SymbolTablePtr</span><span class="o">&gt;</span><span class="p">,</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-528" name="crates/conjure-cp-core/src/ast/symbol_table.rs-528"></a><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-529" name="crates/conjure-cp-core/src/ast/symbol_table.rs-529"></a>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-530" name="crates/conjure-cp-core/src/ast/symbol_table.rs-530"></a><span class="hll"><span class="k">impl</span><span class="w"> </span><span class="nb">Iterator</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">SymbolTableIter</span><span class="w"> </span><span class="p">{</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-531" name="crates/conjure-cp-core/src/ast/symbol_table.rs-531"></a><span class="w">    </span><span class="k">type</span><span class="w"> </span><span class="nc">Item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Name</span><span class="p">,</span><span class="w"> </span><span class="n">DeclarationPtr</span><span class="p">);</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-532" name="crates/conjure-cp-core/src/ast/symbol_table.rs-532"></a>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-533" name="crates/conjure-cp-core/src/ast/symbol_table.rs-533"></a><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">next</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nb">Option</span><span class="o">&lt;</span><span class="bp">Self</span><span class="p">::</span><span class="n">Item</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-534" name="crates/conjure-cp-core/src/ast/symbol_table.rs-534"></a><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="k">mut</span><span class="w"> </span><span class="n">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">inner</span><span class="p">.</span><span class="n">next</span><span class="p">();</span>
</pre></div></td></tr></table></div>

            <div class="snippet"><table class="snippettable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span></pre></div></td><td class="code"><div><pre><span></span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-538" name="crates/conjure-cp-core/src/ast/symbol_table.rs-538"></a><span class="w">        </span><span class="c1">// Note that the parent symbol table may be empty - this is why this is a loop!</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-539" name="crates/conjure-cp-core/src/ast/symbol_table.rs-539"></a><span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="n">val</span><span class="p">.</span><span class="n">is_none</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-540" name="crates/conjure-cp-core/src/ast/symbol_table.rs-540"></a><span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="n">parent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">parent</span><span class="p">.</span><span class="n">clone</span><span class="p">()</span><span class="o">?</span><span class="p">;</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-541" name="crates/conjure-cp-core/src/ast/symbol_table.rs-541"></a>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-542" name="crates/conjure-cp-core/src/ast/symbol_table.rs-542"></a><span class="hll"><span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="n">guard</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parent</span><span class="p">.</span><span class="n">read</span><span class="p">();</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-543" name="crates/conjure-cp-core/src/ast/symbol_table.rs-543"></a><span class="hll"><span class="w">            </span><span class="bp">self</span><span class="p">.</span><span class="n">inner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">guard</span><span class="p">.</span><span class="n">table</span><span class="p">.</span><span class="n">clone</span><span class="p">().</span><span class="n">into_iter</span><span class="p">();</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-544" name="crates/conjure-cp-core/src/ast/symbol_table.rs-544"></a><span class="hll"><span class="w">            </span><span class="bp">self</span><span class="p">.</span><span class="n">parent</span><span class="p">.</span><span class="n">clone_from</span><span class="p">(</span><span class="o">&amp;</span><span class="n">guard</span><span class="p">.</span><span class="n">parent</span><span class="p">);</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-545" name="crates/conjure-cp-core/src/ast/symbol_table.rs-545"></a>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-546" name="crates/conjure-cp-core/src/ast/symbol_table.rs-546"></a><span class="w">            </span><span class="n">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">inner</span><span class="p">.</span><span class="n">next</span><span class="p">();</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-547" name="crates/conjure-cp-core/src/ast/symbol_table.rs-547"></a><span class="w">        </span><span class="p">}</span>
</pre></div></td></tr></table></div>

            <div class="snippet"><table class="snippettable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span></pre></div></td><td class="code"><div><pre><span></span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-560" name="crates/conjure-cp-core/src/ast/symbol_table.rs-560"></a><span class="c1">//       we could remove some of this manual code</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-561" name="crates/conjure-cp-core/src/ast/symbol_table.rs-561"></a><span class="k">impl</span><span class="w"> </span><span class="n">Uniplate</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">SymbolTable</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-562" name="crates/conjure-cp-core/src/ast/symbol_table.rs-562"></a><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">uniplate</span><span class="p">(</span><span class="o">&amp;</span><span class="bp">self</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">Tree</span><span class="o">&lt;</span><span class="bp">Self</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="nb">Box</span><span class="o">&lt;</span><span class="k">dyn</span><span class="w"> </span><span class="nb">Fn</span><span class="p">(</span><span class="n">Tree</span><span class="o">&lt;</span><span class="bp">Self</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nc">Self</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-563" name="crates/conjure-cp-core/src/ast/symbol_table.rs-563"></a><span class="w">        </span><span class="c1">// do not recurse up parents, that would be weird?</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-564" name="crates/conjure-cp-core/src/ast/symbol_table.rs-564"></a><span class="hll"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="n">self2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="p">.</span><span class="n">clone</span><span class="p">();</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-565" name="crates/conjure-cp-core/src/ast/symbol_table.rs-565"></a><span class="hll"><span class="w">        </span><span class="p">(</span><span class="n">Tree</span><span class="p">::</span><span class="n">Zero</span><span class="p">,</span><span class="w"> </span><span class="nb">Box</span><span class="p">::</span><span class="n">new</span><span class="p">(</span><span class="k">move</span><span class="w"> </span><span class="o">|</span><span class="n">_</span><span class="o">|</span><span class="w"> </span><span class="n">self2</span><span class="p">.</span><span class="n">clone</span><span class="p">()))</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-566" name="crates/conjure-cp-core/src/ast/symbol_table.rs-566"></a><span class="hll"><span class="w">    </span><span class="p">}</span>
</span><a id="crates/conjure-cp-core/src/ast/symbol_table.rs-567" name="crates/conjure-cp-core/src/ast/symbol_table.rs-567"></a><span class="p">}</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-568" name="crates/conjure-cp-core/src/ast/symbol_table.rs-568"></a>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-569" name="crates/conjure-cp-core/src/ast/symbol_table.rs-569"></a><span class="k">impl</span><span class="w"> </span><span class="n">Biplate</span><span class="o">&lt;</span><span class="n">SymbolTablePtr</span><span class="o">&gt;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">SymbolTable</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/ast/symbol_table.rs-570" name="crates/conjure-cp-core/src/ast/symbol_table.rs-570"></a><span class="w">    </span><span class="k">fn</span><span class="w"> </span><span class="nf">biplate</span><span class="p">(</span>
</pre></div></td></tr></table></div>

            </div>
        </div>
        <div class="src-snippet">
            <div class="src-name">crates/conjure-cp-core/src/parse/parse_model.rs</div>
            <div class="snippets">
            <div class="snippet"><table class="snippettable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span></pre></div></td><td class="code"><div><pre><span></span><a id="crates/conjure-cp-core/src/parse/parse_model.rs-767" name="crates/conjure-cp-core/src/parse/parse_model.rs-767"></a><span class="w">            </span><span class="p">}</span>
<a id="crates/conjure-cp-core/src/parse/parse_model.rs-768" name="crates/conjure-cp-core/src/parse/parse_model.rs-768"></a><span class="w">            </span><span class="n">otherwise</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">bug</span><span class="o">!</span><span class="p">(</span><span class="s">&quot;Unhandled Op {:#?}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">otherwise</span><span class="p">),</span>
<a id="crates/conjure-cp-core/src/parse/parse_model.rs-769" name="crates/conjure-cp-core/src/parse/parse_model.rs-769"></a><span class="w">        </span><span class="p">},</span>
<a id="crates/conjure-cp-core/src/parse/parse_model.rs-770" name="crates/conjure-cp-core/src/parse/parse_model.rs-770"></a><span class="w">        </span><span class="n">Value</span><span class="p">::</span><span class="n">Object</span><span class="p">(</span><span class="n">comprehension</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">comprehension</span><span class="p">.</span><span class="n">contains_key</span><span class="p">(</span><span class="s">&quot;Comprehension&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/parse/parse_model.rs-771" name="crates/conjure-cp-core/src/parse/parse_model.rs-771"></a><span class="hll"><span class="w">            </span><span class="nb">Some</span><span class="p">(</span><span class="n">parse_comprehension</span><span class="p">(</span><span class="n">comprehension</span><span class="p">,</span><span class="w"> </span><span class="n">scope</span><span class="p">.</span><span class="n">clone</span><span class="p">(),</span><span class="w"> </span><span class="nb">None</span><span class="p">).</span><span class="n">unwrap</span><span class="p">())</span>
</span><a id="crates/conjure-cp-core/src/parse/parse_model.rs-772" name="crates/conjure-cp-core/src/parse/parse_model.rs-772"></a><span class="w">        </span><span class="p">}</span>
<a id="crates/conjure-cp-core/src/parse/parse_model.rs-773" name="crates/conjure-cp-core/src/parse/parse_model.rs-773"></a><span class="w">        </span><span class="n">Value</span><span class="p">::</span><span class="n">Object</span><span class="p">(</span><span class="n">refe</span><span class="p">)</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">refe</span><span class="p">.</span><span class="n">contains_key</span><span class="p">(</span><span class="s">&quot;Reference&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/parse/parse_model.rs-774" name="crates/conjure-cp-core/src/parse/parse_model.rs-774"></a><span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">refe</span><span class="p">[</span><span class="s">&quot;Reference&quot;</span><span class="p">].</span><span class="n">as_array</span><span class="p">()</span><span class="o">?</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">as_object</span><span class="p">()</span><span class="o">?</span><span class="p">[</span><span class="s">&quot;Name&quot;</span><span class="p">].</span><span class="n">as_str</span><span class="p">()</span><span class="o">?</span><span class="p">;</span>
<a id="crates/conjure-cp-core/src/parse/parse_model.rs-775" name="crates/conjure-cp-core/src/parse/parse_model.rs-775"></a><span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="n">user_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Name</span><span class="p">::</span><span class="n">User</span><span class="p">(</span><span class="n">Ustr</span><span class="p">::</span><span class="n">from</span><span class="p">(</span><span class="n">name</span><span class="p">));</span>
</pre></div></td></tr></table></div>

            <div class="snippet"><table class="snippettable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span></pre></div></td><td class="code"><div><pre><span></span><a id="crates/conjure-cp-core/src/parse/parse_model.rs-1088" name="crates/conjure-cp-core/src/parse/parse_model.rs-1088"></a><span class="p">}</span>
<a id="crates/conjure-cp-core/src/parse/parse_model.rs-1089" name="crates/conjure-cp-core/src/parse/parse_model.rs-1089"></a>
<a id="crates/conjure-cp-core/src/parse/parse_model.rs-1090" name="crates/conjure-cp-core/src/parse/parse_model.rs-1090"></a><span class="k">fn</span><span class="w"> </span><span class="nf">parse_flatten_op</span><span class="p">(</span>
<a id="crates/conjure-cp-core/src/parse/parse_model.rs-1091" name="crates/conjure-cp-core/src/parse/parse_model.rs-1091"></a><span class="w">    </span><span class="n">op</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="nc">serde_json</span><span class="p">::</span><span class="n">Map</span><span class="o">&lt;</span><span class="nb">String</span><span class="p">,</span><span class="w"> </span><span class="n">Value</span><span class="o">&gt;</span><span class="p">,</span>
<a id="crates/conjure-cp-core/src/parse/parse_model.rs-1092" name="crates/conjure-cp-core/src/parse/parse_model.rs-1092"></a><span class="hll"><span class="w">    </span><span class="n">scope</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="nc">SymbolTablePtr</span><span class="p">,</span>
</span><a id="crates/conjure-cp-core/src/parse/parse_model.rs-1093" name="crates/conjure-cp-core/src/parse/parse_model.rs-1093"></a><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nb">Option</span><span class="o">&lt;</span><span class="n">Expression</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-core/src/parse/parse_model.rs-1094" name="crates/conjure-cp-core/src/parse/parse_model.rs-1094"></a><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">args</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">op</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;MkOpFlatten&quot;</span><span class="p">)</span><span class="o">?</span><span class="p">.</span><span class="n">as_array</span><span class="p">()</span><span class="o">?</span><span class="p">;</span>
<a id="crates/conjure-cp-core/src/parse/parse_model.rs-1095" name="crates/conjure-cp-core/src/parse/parse_model.rs-1095"></a>
<a id="crates/conjure-cp-core/src/parse/parse_model.rs-1096" name="crates/conjure-cp-core/src/parse/parse_model.rs-1096"></a><span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parse_expression</span><span class="p">(</span><span class="o">&amp;</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">scope</span><span class="p">);</span>
</pre></div></td></tr></table></div>

            </div>
        </div>
        <div class="src-snippet">
            <div class="src-name">crates/conjure-cp-essence-parser/src/parser/expression.rs</div>
            <div class="snippets">
            <div class="snippet"><table class="snippettable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span></pre></div></td><td class="code"><div><pre><span></span><a id="crates/conjure-cp-essence-parser/src/parser/expression.rs-36" name="crates/conjure-cp-essence-parser/src/parser/expression.rs-36"></a><span class="k">fn</span><span class="w"> </span><span class="nf">parse_dominance_relation</span><span class="p">(</span>
<a id="crates/conjure-cp-essence-parser/src/parser/expression.rs-37" name="crates/conjure-cp-essence-parser/src/parser/expression.rs-37"></a><span class="w">    </span><span class="n">node</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="nc">Node</span><span class="p">,</span>
<a id="crates/conjure-cp-essence-parser/src/parser/expression.rs-38" name="crates/conjure-cp-essence-parser/src/parser/expression.rs-38"></a><span class="w">    </span><span class="n">source_code</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="kt">str</span><span class="p">,</span>
<a id="crates/conjure-cp-essence-parser/src/parser/expression.rs-39" name="crates/conjure-cp-essence-parser/src/parser/expression.rs-39"></a><span class="w">    </span><span class="n">root</span><span class="p">:</span><span class="w"> </span><span class="kp">&amp;</span><span class="nc">Node</span><span class="p">,</span>
<a id="crates/conjure-cp-essence-parser/src/parser/expression.rs-40" name="crates/conjure-cp-essence-parser/src/parser/expression.rs-40"></a><span class="hll"><span class="w">    </span><span class="n">symbols_ptr</span><span class="p">:</span><span class="w"> </span><span class="nb">Option</span><span class="o">&lt;</span><span class="n">SymbolTablePtr</span><span class="o">&gt;</span><span class="p">,</span>
</span><a id="crates/conjure-cp-essence-parser/src/parser/expression.rs-41" name="crates/conjure-cp-essence-parser/src/parser/expression.rs-41"></a><span class="p">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nb">Result</span><span class="o">&lt;</span><span class="n">Expression</span><span class="p">,</span><span class="w"> </span><span class="n">EssenceParseError</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-essence-parser/src/parser/expression.rs-42" name="crates/conjure-cp-essence-parser/src/parser/expression.rs-42"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">root</span><span class="p">.</span><span class="n">kind</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;dominance_relation&quot;</span><span class="w"> </span><span class="p">{</span>
<a id="crates/conjure-cp-essence-parser/src/parser/expression.rs-43" name="crates/conjure-cp-essence-parser/src/parser/expression.rs-43"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nb">Err</span><span class="p">(</span><span class="n">EssenceParseError</span><span class="p">::</span><span class="n">syntax_error</span><span class="p">(</span>
<a id="crates/conjure-cp-essence-parser/src/parser/expression.rs-44" name="crates/conjure-cp-essence-parser/src/parser/expression.rs-44"></a><span class="w">            </span><span class="s">&quot;Nested dominance relations are not allowed&quot;</span><span class="p">.</span><span class="n">to_string</span><span class="p">(),</span>
</pre></div></td></tr></table></div>

            </div>
        </div>
    </body>
</html>